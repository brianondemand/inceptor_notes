
**OpenVAS**, an application used to scan endpoints and web applications to identify and detect vulnerabilities. 

It is commonly used by corporations as part of their mitigation solutions to quickly identify any gaps in their production or even development servers or applications. This is not an end all be all solution but can help to get rid of any common vulnerabilities that may have slipped through the cracks.

From the OpenVAS GitHub repository “This is the Open Vulnerability Assessment Scanner (OpenVAS) of the Greenbone Vulnerability Management (GVM) Solution. 

It is used for the Greenbone Security Manager appliances and is a full-featured scan engine that executes a continuously updated and extended feed of Network Vulnerability Tests (NVTs).”

#### Features

**1. Vulnerability scanning.**  
OpenVAS framework scans systems for vulnerabilities, missing patches, misconfigurations, and other security related issues.

**2. Compliance auditing.**  
The Greebone OpenVAS performs compliance checks against various standards, such as PCI-DSS, HIPAA, GDPR, and others.  
  
**3. Extensive Vulnerability Database**  
OpenVAS uses a regularly updated databases of over 100,000 vulnerability tests, known as Network Vulnerability Tests (NVTs).  
  
**4. Reporting and alerts**  
The Greenbone OpenVAS framework generates detailed reports on the basis of detected vulnerabilities, their severity, and remediation steps. The reports can be customized as per organization’s requirements and can also be exported in various file formats (e.g., HTML, PDF, etc.).  
  
**5. Integration capabilities**  
OpenVAS can be integrated with other third-party security tools, systems, CI/CD pipelines, and also provides API access to enhance the security posture.  
  
**6. Open Source**  
Greenbone OpenVAS is freely available and high customizable, allows users to tailor the tool to their specific needs.



### Components

 **1. OpenVAS Scanner**  
The OpenVAS Scanner is the core engine that performs the scanning operations. The scanner runs various Network Vulnerability Tests (NVTs) against the targets to detect vulnerabilities.

**2. OpenVAS Manager**  
OpenVAS Manager component manages scan configurations, schedules, and stores the results. The manager orchestrates the scanning process and manages the generated information.  
  
**3. Greenbone Security Assistant (GSA)**  
The Greenbone Security Assistant (GSA) is the web-based interface to interact with OpenVAS. Also provides an intuitive way to configure scans, review results, and generate reports.  
  
**4. Greenbone Vulnerability Manager (GVM)**
Greenbone Vulnerability Manager component manages the overall vulnerability assessment process, handling the NVTs, user management, and also the report generation.  
  
**5. Greenbone Community Feed**  
The Greenbone Community Feed is a free vulnerability feed provided by Greenbone Networks, which includes thousands of NVTs. This feed is regularly updated to include the latest vulnerabilities and exploits.


---



## Installation on Kali

Before installing the Greenbone OpenVAS framework, there are some prerequisite steps to be done.

Let’s start with the repository updation of Kali Linux OS.

> **sudo apt update**

![](https://miro.medium.com/v2/resize:fit:640/format:webp/1*s4Yo9im3kC-XaU-oNTDsng.png)

Now we’ll install the latest available packages which are cached from repository retrieving process (previous step).

> **sudo apt upgrade**

![](https://miro.medium.com/v2/resize:fit:640/format:webp/1*D87KQolHilqFrQ24l35kKQ.png)

sudo apt upgrade

The final prerequisite step is to upgrade the Kali Linux OS distribution packages.

> **sudo apt dist-upgrade**

![](https://miro.medium.com/v2/resize:fit:640/format:webp/1*8c3jxgoL2DlnpuHPT8cYbw.png)

sudo apt dist-upgrade

***After the successful completion of updating and upgrading the Kali Linux OS, restart the machine.***

Now let’s get into the actual installation of Greenbone OpenVAS framework.

> **sudo apt install openvas\***

![](https://miro.medium.com/v2/resize:fit:640/format:webp/1*p8EzwOOuLT7iLpTr54xu1A.png)

sudo apt install openvas\*

Once the openvas packages are installed, let’s execute the setup command.

> **sudo gvm-setup**

![](https://miro.medium.com/v2/resize:fit:640/format:webp/1*MLnsGtEgkqVderFLnoDFAA.png)

sudo gvm-setup

If the package installations are successful, we’ll be provided a password for the user “admin” as shown below.

![](https://miro.medium.com/v2/resize:fit:640/format:webp/1*oW-sNiErmh66i6M81ztDkg.png)

***The provided password for the user “admin” should be noted.***

The next step is to verify the installation of OpenVAS.

> **sudo gvm-check-setup**

![](https://miro.medium.com/v2/resize:fit:640/format:webp/1*QDWrSS1Zz50IcFm_jaoOPw.png)

sudo gvm-check-setup

![](https://miro.medium.com/v2/resize:fit:640/format:webp/1*lbbOG22FLhURghMXOAcOhA.png)

The whole OpenVAS framework installation and configuration was successful. Before starting the OpenVAS services, first let’s stop all services which are related to the OpenVAS framework.

> **sudo gvm-stop**

Let’s start the Greenbone OpenVAS services now.

> **sudo gvm-start**

![](https://miro.medium.com/v2/resize:fit:640/format:webp/1*ANLSN2UANcZsnD0u5jUfhA.png)

sudo gvm-start

![](https://miro.medium.com/v2/resize:fit:640/format:webp/1*fuIzwxe_IZRDr--N5SbBeQ.png)

Once the services are started successfully, a web UI link will be given.

> **http://127.0.0.1:9392**

When we visit the above mentioned link in the browser for the first time, due to security reasons we’ll have to click on ***Advanced*** and ***Accept the Risk and Continue.***

![](https://miro.medium.com/v2/resize:fit:640/format:webp/1*jnXpCTdxXSVR67fJTPBqIQ.png)

![](https://miro.medium.com/v2/resize:fit:640/format:webp/1*W-kRdqV9CaLb5m4NG0-9cQ.png)

![](https://miro.medium.com/v2/resize:fit:640/format:webp/1*U8elMRjgKAPpJcS9Iry8PQ.png)

The installation and the configuration of Greenbone OpenVAS framework has been successfully completed. But the user “admin” is still using the automatically generated password for logging. Let’s change the password using the web interface.

Go to the top right corner of the webpage, click on the user avatar.

![](https://miro.medium.com/v2/resize:fit:640/format:webp/1*xiSFjAay2GQkoZ_0NRYtlg.png)

Then click on “ ***My Settings*** ”.

![](https://miro.medium.com/v2/resize:fit:640/format:webp/1*kU6k4NBtxucR8r_U3xMMjw.png)

User Settings Page

![](https://miro.medium.com/v2/resize:fit:640/format:webp/1*USDXX5YICM-ciNSmzdk2Kw.png)

![](https://miro.medium.com/v2/resize:fit:640/format:webp/1*oB2K4FQqwYSTNII89x4OjA.png)

Input the old password and the new password, then click ***Save***.

***Logout and login with the new password.***

**The Greenbone OpenVAS framework has been installed successfully.**

---
##  Installing OpenVAS Docker

I install it using Docker. Here we go..

Docker is by far the easiest of all three installation methods and only requires one command to be run to get the client started. For this installation procedure, you will need docker installed.

For more information about this information procedure checkout the openvas-docker project on [GitHub](https://github.com/mikesplain/openvas-docker) and [DockerHub](https://hub.docker.com/r/mikesplain/openvas/dockerfile).

1\. `apt install docker.io`

2\. `docker run -d -p 443:443 --name openvas mikesplain/openvas`

![](https://miro.medium.com/v2/resize:fit:640/format:webp/0*-9ilU3FfJBVZP_Yk.png)

This command will both pull the docker container and then run the container. It may take a few minutes for the container to fully set up and begin running. Once it is complete you can then navigate to [https://127.0.0.1](https://127.0.0.1/) in your preferred browser and OpenVAS will be setup and ready to go!

Below are the default credentials to access OpenVAS/GVM:

**Username:**`admin`

**Password:**`admin`

---

##  Initial Configuration

Before we can start scanning and implementing OpenVAS into our vulnerability management solution we need to do a little bit of maintenance and configuration to get OpenVAS properly working. Luckily for us, OpenVAS makes the process very easy and includes a wizard to make the process straightforward.

Begin by navigating to *Scans > Tasks* and clicking on the purple magic wand icon to begin the basic configuration wizard.

We recommend beginning a scan on `127.0.0.1` to test out your installation and ensure it is working properly.

![](https://miro.medium.com/v2/resize:fit:640/format:webp/0*CWBeehu9nnreRE44.png)

If you successfully navigated to the wizard you should see a pop-up similar to the one above. This is where you will set up your initial scan against your localhost to ensure everything is properly configured.

The scan may take a while to complete, allow OpenVAS enough time to finish the scan, and then you will be met with a new dashboard for monitoring and analyzing your complete and ongoing scans like the one below.

![](https://miro.medium.com/v2/resize:fit:640/format:webp/0*R1uqZI2DrP3_EFGe.png)

Once your scan has finished, you can navigate to *Scans > Reports* and click on your newly created report from your previous task.

![](https://miro.medium.com/v2/resize:fit:640/format:webp/0*hfn4wRBx0DFwMrMt.png)

If correctly configured you should see three different vulnerabilities reported all originating from OpenVAS itself. This is normal behavior and can be configured/changed to maintain your OpSec.

---

## Scanning Infrastructure

Now that we know that everything is working we can get into the nitty-gritty of OpenVAS and how it works. Deploy the machine and navigate to *Scans > Tasks* to begin creating a task to scan the provided machine.

Creating a Task:

To create a configurable task navigate to the star icon in the upper right-hand corner of the *Tasks* dashboard and select *New Task*.

![](https://miro.medium.com/v2/resize:fit:640/format:webp/0*pGsq29KxpB5nIsTC.png)

Once you select New Task from the dropdown you will be met with a large pop-up with many options. We will break down each of the options sections and what they can be used for.

![](https://miro.medium.com/v2/resize:fit:640/format:webp/0*BvYaIyo7Jtnk86a_.png)

For this task, we will be focusing only on the Name, Scan Targets, and Scanner Type, and Scan Config. In later tasks, we will be focusing on the other options for more advanced configuration and implementation/automation.

1. Name: Allows us to set the name the scan will be known as inside of OpenVAS
   
2. Scan Targets: The targets to scan, can include Hosts, Ports, and Credentials. To create a new target you will need to follow another pop-up, this will be covered later in this task.
   
3. Scanner: The scanner to use by default will use the OpenVAS architecture however you can set this to any scanner of your choosing in the settings menu.
   
4. Scan Config: OpenVAS has seven different scan types you can select from and will be used based on how you aggressive or what information you want to collect from your scan.

Scoping a New Target

To scope a new target, navigate to the star icon next to *Scan Targets*.

![](https://miro.medium.com/v2/resize:fit:640/format:webp/0*TTPRFerNjtYIgG6g.png)


Above is the menu for configuring a new target. The two main options you will need to configure are the Name and the Hosts. This procedure is fairly straight forward and other options will only be used in advanced vulnerability management solutions. These will be covered in later tasks.

![](https://miro.medium.com/v2/resize:fit:640/format:webp/0*KY5dtBv-sRTobNwg.png)

Now that we have our target scoped we can continue to create our task and begin the scan.

Once you create the task you will be brought back to the scan dashboard where you can monitor and start your task. To start the task navigate to the start icon under *Actions*.

![](https://miro.medium.com/v2/resize:fit:640/format:webp/0*CHpTCqdkoLvqJz7K.png)



---
##  Reporting and Continuous Monitoring

OpenVAS has very strong reporting and monitoring capabilities that can contribute to an efficient and optimal solution in your build or vulnerability management pipeline.

Download the provided report from a vulnerable machine to get familiar with the automated reporting capabilities of OpenVAS.

![](https://miro.medium.com/v2/resize:fit:640/format:webp/1*RiY4bZs6noN1PWLK_wSCmA.png)

Breaking Down the Report

The automated report from OpenVAS begins with some basic host and task information including Host, Start, End, and Vulnerability categories. It will also check for host authentications and an overall summary of open ports on the host.

![](https://miro.medium.com/v2/resize:fit:640/format:webp/0*LuKfjaEhI-XDiarq.png)

After the basic host and task information OpenVAS will report on each of the vulnerabilities found.

![](https://miro.medium.com/v2/resize:fit:640/format:webp/0*P4lNzL1iE1ONrkPh.png)

In the above image, the vulnerability breakdown can give a lot of information. We can gather a summary of the vulnerability, detection details, mitigation details, and method of detection.

Continuous Monitoring Overview

OpenVAS offers many options for continuous and scheduled monitoring/vulnerability management. If you work in a team or a pipeline this can allow you to efficiently and quickly optimize your current solutions. Examples of continuous vulnerability scanning utilities are Alerts, Schedules, and Agents. Agents are out of scope for this room but we will be covering the configuration of schedules and alerts below.

Creating Schedules

To begin creating a schedule navigate to *Configuration > Schedules* and as always click on the blue star icon in the upper left-hand corner. You should see a pop-up similar to the one below.

![](https://miro.medium.com/v2/resize:fit:640/format:webp/0*QOwvPz-fZTFdLVP9.png)

Fill out the basic information like Name, First Start Time, Period, etc. Once you have the schedule created you can now create a new Task/Scan with this created schedule attached. You can see this option below.

![](https://miro.medium.com/v2/resize:fit:640/format:webp/0*dl9TL-G_d_dKLu9m.png)

Crafting Alerts

The process for creating alerts is very similar to creating a schedule, navigate to *Configuration > Alerts* and click on the blue star icon in the upper left-hand corner. You should see a pop-up similar to the one below.

![](https://miro.medium.com/v2/resize:fit:640/format:webp/0*6rMl8dRUosPNfbLZ.png)

You will notice that there are a lot more options than the schedule menu, don’t let this intimidate you, the process is very similar and straightforward. The main options you will need to worry about are Name, Event, Condition, and To Address. The event can be configured to alert based on the status of the scan or when a new NVT/vulnerability is detected. The condition option will make sure that your inbox isn’t flooded with alerts, this can be changed based on severity or filters. The To Address is fairly self-explanatory and will send an email of the alert to the specified mail address. Once created you will again need to connect the alert to a new Task/Scan. You can see the specific option below.

![](https://miro.medium.com/v2/resize:fit:640/format:webp/0*8GzOR2gRgNl2mMaF.png)


---
