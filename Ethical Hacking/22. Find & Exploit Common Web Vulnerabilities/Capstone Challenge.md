We are given a website with almost no functionality except we sign up , and then login with the account created

![](https://i.imgur.com/msJAmfQ.png)


We did sign up as user `bankai` , and then logged in

![](https://i.imgur.com/SgYaaR3.jpg)

## **Vulnerability Detection**

Decided to run a directory bruteforce and only `/admin` looks interesting

![](https://i.imgur.com/fEKrTZh.png)

Navigating to `/admin` we get this error

![](https://i.imgur.com/rAkkOWy.png)


**Tip ðŸ’¡ :** If you don't have access to a particular directory on a website, we can try to fuzz what is inside that directory and see if we have direct access, here we have found `/admin/admin.php` using `ffuf` to fuzz for content

![](https://i.imgur.com/LRzM6Zu.png)


Navigating to `/admin/admin.php` we have an error message which says **"Admins only!"**, meaning i am a lower privileged user and i need to login as an higher privilege user to view this page


![](https://i.imgur.com/pPixi2c.png)

Tried out **HTML injection** and yeah the vulnerability exists, so we have potential **XSS** and **SQLI** since the content of message got reflected on the web page, We can the decide to intercept request with burp, save the request and pass it to `sqlmap` to see if it is possible

![](https://i.imgur.com/ykWMBGO.png)

Manual testing still beats all, i tried using the `/capstone?message=` parameter and my **SQLI** kept failing, but clicking on **add rating** on one of the items and checking things out the **SQLI** and **XSS** truly exist there

![](https://i.imgur.com/OiuGV82.png)

**Note :** if the comment `#` doesn't work try `-- -` , took me long enough to figure this out


Now we can intercept this particular request with `burp` and pass it to `sqlmap` and then dump the **users** table  (manual testing)

![](https://i.imgur.com/yUbA8vi.gif)


We got the hash of the admin users which are **Jeremy, Jessamy and Raj** , we can then attempt to crack it since we know it is **blowfish**

![](https://i.imgur.com/y3eyW8h.png)

As shown above, the specified password belongs to user:**jeremy**, we can then attempt to login as this user via the web page

![](https://i.imgur.com/vNXUqrp.png)


Now navigate to `/admin/admin.php` and we should be able to view the page

![](https://i.imgur.com/v3lXco9.png)

Nice looks like we have a file upload functionality, we can then try to upload our malicious `PHP` web shell, try uploading a normal `PNG` file and then intercept request, add our `PHP` payload script, change extension and submit

![](https://i.imgur.com/tEfmYhN.png)

**Note :** I left a little out of the `PNG` data so it might just recognize it

Inspecting Elements of the website where it got uploaded too i can see the file was uploaded to `/assets`

![](https://i.imgur.com/kpAhDNQ.png)
Navigating to `assets/10.png` i did not find anything but doing `/asstes/10.php` gives us our webshell

![](https://i.imgur.com/HTUqI3Y.png)


From here on we can then attempt to level up and get a reverse shell GG

