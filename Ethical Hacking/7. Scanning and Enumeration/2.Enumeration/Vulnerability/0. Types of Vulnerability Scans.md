
Vulnerability scans are controlled by scan policies defined in automated tools. These tools often allow for full scans using all available options. 

However, in sensitive environments like production systems or unstable devices, only safe scan options should be selected to prevent crashes. 

The main types of vulnerability scans are **unauthenticated scans**, **authenticated scans**, **discovery scans**, **full scans**, **stealth scans**, and **compliance scans**.

#### Unauthenticated Scans

These scans are performed without any credentials. When only an IP address is provided, the scan mimics the perspective of an external attacker who does not have access to the system. 

It identifies only the services exposed to the network by checking for open ports. If a port is firewalled or not listening on the scanner’s network segment, it will appear closed. 

However, this doesn’t always mean it's not vulnerable — hidden ports can sometimes still be accessed using advanced methods like SSH port forwarding. Since unauthenticated scans provide limited internal visibility, they often produce more false positives compared to authenticated scans.

**Nmap Command Example**:

```
nmap -sS -T4 <target-IP>
```

- `-sS`: TCP SYN scan (stealthy and fast)

- `-T4`: Aggressive timing (faster scan)

#### Authenticated Scans

Authenticated scans involve logging into the target system using credentials with root or administrative privileges. This gives the scanner deeper insight into the system’s configuration and vulnerabilities. 

The scanner uses tools like `netstat` to list open ports and associated services. The results of these commands vary depending on the level of access. For instance, when run by a regular user, the `netstat` output hides information such as the PID and program name, whereas with root access, detailed process information is shown. 

This visibility makes authenticated scans more reliable and effective for identifying real threats.

**Tools**: Nessus, OpenVAS, Qualys

```
netstat -tulnp
```

- `-t`: TCP connections

- `-u`: UDP connections

- `-l`: Listening ports

- `-n`: Show numeric IPs/ports

- `-p`: Show process name (requires root)


**Authenticated Scanner Command Example (Nessus)**:

Nessus allows setting SSH or Windows credentials via its GUI or command-line.

 Example using SSH:

```
nessuscli scan --target <IP> --ssh-credentials <user>:<pass>
```

- Provides **more accurate and detailed results**, reduces false positives, and detects issues not visible to unauthenticated scans.

#### Discovery Scans

Discovery scans are primarily used to map out the target's attack surface. They start with a basic port scan, often using tools like Nmap, to determine which ports are open. 

Once open ports are identified, the scanner attempts to determine the exact services running on those ports. For example, it may detect an Apache Tomcat web server on ports 80 and 443 or an OpenSSH service on port 22. 

After identifying these services, the scanner conducts further probes tailored to each one, such as checking for outdated versions or weak configurations. 

Discovery scans provide foundational information that informs deeper vulnerability assessments.

**Nmap Command Example**:

```
nmap -sV -O -T4 <target-IP>
```

- `-sV`: Service/version detection

- `-O`: OS detection

- `-T4`: Speeds up scan


**Masscan Command (fastest port scanner)**:

```
masscan -p1-65535 <target-IP> --rate=10000
```

- Discovery scans are useful for **enumerating all accessible services** before running deeper scans.

#### Full Scans

A full scan is a comprehensive scan that activates every available scanning option defined in the tool’s scan policy. This includes a wide range of checks against services, configurations, user permissions, and more. Full scans are generally used in test environments rather than live systems, as they can be intrusive and might disrupt services or cause system instability if misconfigured.

```
nessuscli scan --policy "Full Scan" --target <IP>
```



---

#### Challenges to Consider When Running a Vulnerability Scan

1. **System and Network Performance Impact**  
    Vulnerability scans can consume significant bandwidth and system resources, potentially degrading network or application performance.

2. **False Positives and False Negatives**  
    Scans may report vulnerabilities that don't exist (false positives) or miss actual issues (false negatives), leading to mistrust in scan results or missed threats.

3. **Authentication Issues**  
    Lack of proper credentials in authenticated scans can limit visibility, while incorrect credentials may result in incomplete or failed scans.

4. **Access Restrictions**  
    Firewalls, IDS/IPS, and ACLs can block scan attempts, resulting in incomplete data.

5. **Disruption of Services**  
    Aggressive scanning (e.g., full scans) may disrupt critical services or trigger security defenses unintentionally.

6. **Scope Definition and Asset Inventory**  
    Poorly defined scope or outdated asset lists can lead to incomplete scanning or legal issues if unauthorized systems are probed.

7. **Scan Configuration Complexity**  
    Incorrect configuration of scan tools can lead to ineffective results or increased risk of disruption.

8. **Legal and Compliance Concerns**  
    Some scans may violate internal policies or regulatory requirements if not planned properly.

9. **Timing and Frequency**  
    Running scans at the wrong time (e.g., during peak hours) can affect operations; infrequent scans may miss new vulnerabilities.

10. **Data Overload and Prioritization**  
    Large volumes of results can overwhelm teams, making it hard to prioritize which vulnerabilities to address first.

---

