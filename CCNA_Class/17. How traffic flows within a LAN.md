## Ethernet LAN Switching

Ethernet switching is a crucial component of modern networking, enabling efficient communication within local area networks (LANs). This article explores the key concepts of Ethernet switching, including MAC addresses, frame forwarding mechanisms, switch learning processes, VLANs, Spanning Tree Protocol (STP), and network security considerations.\

### Protocol Data Unit (PDU)

**PDU (Protocol Data Unit)** refers to a **layer-specific data packet** that is transmitted across a network. Each layer in the **OSI model** has its own form of PDU.

**PDUs in the OSI Model**

Here’s how PDUs are named at different layers:

1. **Layer 1 (Physical)** – **Bits** (Raw data as electrical, optical, or radio signals)
2. **Layer 2 (Data Link)** – **Frames** (Encapsulates packets with MAC addresses for local delivery)
3. **Layer 3 (Network)** – **Packets** (Contains IP addresses for routing across networks)
4. **Layer 4 (Transport)** – **Segments (TCP) / Datagrams (UDP)** (Handles end-to-end communication)
5. **Layer 5-7 (Session, Presentation, Application)** – **Data** (User-readable data)

## Ethernet Frames

Ethernet frames are the data units used in Ethernet-based networks. It encapsulates data and control information, ensuring efficient transmission between devices.

Each frame consists of key components that facilitate proper data transmission and error detection.

### Structure of an Ethernet Frame

![][https://www.omnisecu.com/images/tcpip/frame-header-trailer-data.jpg?ezimgfmt=ngcb3/notWebP]


Here’s a breakdown of its structure:

1. **Preamble (7 bytes)**  
   - A sequence of alternating **1s and 0s** (101010... pattern).  
   - Used for **clock synchronization** between sender and receiver.

2. **Start Frame Delimiter (SFD) (1 byte)**  
   - Marks the exact start of the frame with a **10101011** sequence.  
   - Ensures that the receiver can **identify** the beginning of the frame.

3. **Destination MAC Address (6 bytes)**  
   - **Identifies the receiver** in the network.  
   - If **broadcast**, it’s **FF:FF:FF:FF:FF:FF**.

4. **Source MAC Address (6 bytes)**  
   - **Identifies the sender’s** MAC address.

5. **EtherType / Length (2 bytes)**  
   - If **≤ 1500**, it represents the length of the payload (IEEE 802.3).  
   - If **≥ 1536**, it indicates the protocol type (EtherType), e.g.:
     - `0x0800` → IPv4  
     - `0x86DD` → IPv6  
     - `0x0806` → ARP  

6. **Payload (46 - 1500 bytes)**  
   - Contains **actual data** being transmitted.  
   - If less than 46 bytes, **padding** is added to meet the minimum Ethernet frame size (64 bytes).

7. **Frame Check Sequence (FCS) (4 bytes)**  
   - Uses **Cyclic Redundancy Check (CRC-32)** for **error detection**.  
   - If errors are detected, the frame is discarded.

| Field Name           | Size (Bytes) | Description |
|----------------------|-------------|-------------|
| **Preamble**        | 7           | Synchronization pattern for receiver alignment. |
| **Start Frame Delimiter (SFD)** | 1 | Marks the start of the frame. |
| **Destination MAC Address** | 6 | MAC address of the receiving device. |
| **Source MAC Address** | 6 | MAC address of the sending device. |
| **EtherType / Length** | 2 | Indicates protocol type (IPv4, IPv6, ARP, etc.) or length of data. |
| **Payload (Data & Padding)** | 46-1500 | Actual data being transmitted; minimum 46 bytes (padding used if needed). |
| **Frame Check Sequence (FCS)** | 4 | CRC checksum to detect errors in transmission. |

---
### Types of Ethernet Frames  

  Ethernet frames are the fundamental units of communication in a network. They contain the data being transmitted along with control information. There are three main types of frames based on how they are addressed and delivered:  

**1. Unicast Frame**  
- A **one-to-one** communication between a sender and a single specific receiver.  
- The **destination MAC address** in the frame is a unique MAC address of the intended recipient.  
- Most network traffic is **unicast**, such as web browsing, file transfers, and emails.  
- **Example:** A computer sending a request to a web server.  

**2. Broadcast Frame**  
- A **one-to-all** communication where a frame is sent to **all devices** in the network.  
- The **destination MAC address** is **FF:FF:FF:FF:FF:FF**, which is the universal broadcast address.  
- Used when the sender does not know the recipient’s MAC address.  
- **Example:**  
  - **ARP request**: A device asks, “Who has this IP address?” and all devices listen.  
  - **DHCP Discover**: A client looks for a DHCP server to get an IP address.  
- **Limitation:** Broadcast traffic can lead to **network congestion** in large networks.  

**3. Multicast Frame**  
- A **one-to-many** communication where a frame is sent to **a group of devices** instead of all.  
- The **destination MAC address** is a **multicast MAC address** (e.g., `01:00:5E:xx:xx:xx` for IPv4 multicast).  
- Used in applications like video streaming, online gaming, and routing protocols (OSPF, EIGRP).  
- **Example:** A streaming service sending a video feed to multiple subscribed users without flooding all network devices.  

**How Switches Handle These Frames**  

- **Unicast:** The switch forwards the frame only to the port where the destination MAC is known.  
- **Broadcast:** The switch forwards the frame to **all ports** except the one it was received on.  
- **Multicast:** The switch forwards the frame **only to interested devices** using IGMP (Internet Group Management Protocol). 

#### Known Unicast Frames & Unknown Unicast Frames

A **known unicast frame** is a type of unicast frame where the destination MAC address is already stored in the switch’s MAC address table. When the switch receives such a frame, it looks up the MAC address in its table and forwards the frame directly to the port associated with that MAC address. This makes the transmission efficient because the switch does not need to send the frame to all ports, reducing network congestion.

![[Pasted image 20250218142926.png]]

---

On the other hand, an **unknown unicast frame** occurs when the switch receives a unicast frame with a destination MAC address that is **not** in its MAC address table. In this case, the switch doesn't know where to forward the frame, so it floods the frame to all ports in the VLAN except the port it was received on. This is a less efficient process because the switch must send the frame to all devices, hoping the correct one will respond.

![][https://itnetworkingskills.wordpress.com/wp-content/uploads/2024/05/f4307-unicast-flooding-9.webp]

---
### MAC Address

A MAC address is a unique 48-bit (6-byte) identifier assigned to network interfaces. Also called **Burned-In Address**. Its globally unique meaning there are not the same.

![][https://media.fs.com/images/ckfinder/ftp_images/tutorial/mac-addresse-numbers.jpg]

It consists of two parts:

- **OUI (Organizationally Unique Identifier)** – The first 24 bits identifying the manufacturer.
- **Device Identifier** – The last 24 bits uniquely identifying the specific device.

MAC addresses enable switches to forward frames accurately within a network.

### Types of MAC Addresses

4. **Dynamic MAC Address**  
   - Learned automatically from incoming frames.  
   - Removed after a certain inactivity period (default 300 seconds).  
   - Used in standard networks where devices frequently connect and disconnect.  
   - Command to view:

```c
show mac address-table dynamic
```

5. **Static MAC Address**  
   - Manually configured and permanently stored in the MAC address table.  
   - Provides security by ensuring only specific devices use a particular port.  
   - Commonly used for servers and critical devices.  
   - Configuration example: `mac address-table static <MAC> vlan <VLAN> interface <INTERFACE>`.  
   - Command to view:

```c
show mac address-table static
``` 

6. **Sticky MAC Address**  
   - Automatically learned and stored in the switch configuration.  
   - Remains even after reboot if saved.  
   - Used for securing access ports by preventing unauthorized device connections.  
   - Enabled with the `switchport port-security mac-address sticky` command.  
   - Command to view: 

```c
show mac address-table | include Sticky
```

### MAC Address Table 

A **MAC address table** (also called the **CAM table**) is a database in a switch that stores **MAC addresses and their associated ports**. It helps the switch forward frames efficiently by sending them directly to the correct port instead of broadcasting.  

**How the MAC Address Table Works**  

7. When a switch receives a frame, it checks the **source MAC address** and records it in the MAC address table, associating it with the incoming port.  
8. If the **destination MAC address** is found in the table, the switch forwards the frame to the correct port.  
9. If the destination MAC is **unknown**, the switch floods the frame to all ports except the one it was received on.  
10. If a MAC address remains **inactive for too long**, it is removed from the table (default aging time: 300 seconds).  

**Viewing the MAC Address Table**  

On a Cisco switch, use:  

```bash
show mac address-table
```

This command displays **MAC addresses, VLANs, types (dynamic/static), and associated ports**.  

**Clearing the MAC Address Table**  

To remove all learned MAC addresses:  

```bash
clear mac address-table dynamic
```  

This forces the switch to relearn MAC addresses.  

---


## Introduction to Ethernet LAN Switching

Ethernet is the dominant Layer 2 protocol used in virtually all LANs today. It defines how data packets (frames) are transmitted over wired networks, ensuring efficient communication between devices such as computers, switches, and routers.

A switch is a network device that connects multiple devices within a LAN, forwarding data based on MAC (Media Access Control) addresses. Unlike hubs, which broadcast data to all devices, switches intelligently forward frames to the appropriate destination, reducing network congestion and improving efficiency.




## Switch Learning and Forwarding Process

Switches use a process known as MAC address learning to optimize network performance. This involves:

11. **Learning Phase:** When a switch receives a frame, it examines the source MAC address and records it in its MAC address table, associating it with the inbound port.
12. **Forwarding Phase:** When a frame is received, the switch checks its MAC table to determine the outbound port for the destination MAC address:
    - **Known Unicast Frames** – Forwarded directly to the intended recipient.
    - **Unknown Unicast Frames** – Flooded to all ports except the source port.
    - **Broadcast Frames** – Sent to all devices within the LAN.
    - **Multicast Frames** – Delivered to specific groups of devices.

## Handling Unknown Unicast Frames

If a switch receives a frame destined for an unknown MAC address, it floods the frame to all ports (except the one it was received on). Once the destination device responds, the switch updates its MAC table, ensuring direct forwarding in future transmissions.

## Collision Domains and Full/Half Duplex

Switches help reduce network congestion by segmenting collision domains.

- **Full Duplex:** Devices can send and receive data simultaneously, eliminating collisions.
- **Half Duplex:** Devices take turns sending and receiving, requiring collision detection mechanisms such as CSMA/CD (Carrier Sense Multiple Access with Collision Detection).

## Switching Methods

Switches use different forwarding methods to optimize performance:

- **Store-and-Forward:** The entire frame is received, checked for errors, and then forwarded. This ensures data integrity but introduces latency.
- **Cut-Through:** The switch forwards the frame as soon as the destination MAC address is read, reducing latency but potentially forwarding corrupted frames.
- **Fragment-Free:** A hybrid approach that checks the first 64 bytes before forwarding, balancing speed and error detection.

## MAC Address Aging and Removal

To maintain efficiency, dynamically learned MAC addresses are removed from a switch’s MAC table after **5 minutes** of inactivity. This prevents outdated entries from consuming memory.

## VLANs: Enhancing Network Segmentation

A Virtual Local Area Network (VLAN) is a logical segmentation of a network that enables administrators to group devices regardless of their physical location. VLANs provide several benefits:

- Improved security by isolating network traffic.
- Enhanced performance by reducing broadcast domains.
- Better manageability by logically grouping users and devices.

Each VLAN operates as its own broadcast domain, ensuring that broadcast traffic is confined within its segment.

## Spanning Tree Protocol (STP): Preventing Loops

Redundant paths in a network can lead to switching loops, which cause broadcast storms and degrade performance. STP is a Layer 2 protocol designed to prevent loops by dynamically selecting a root bridge and blocking redundant links while allowing alternative paths if the primary path fails.

### Key STP Features:

- **Root Bridge Election** – Determines the central switch in the topology.
- **Blocking and Forwarding States** – Controls the activation of switch ports.
- **Rapid Spanning Tree Protocol (RSTP)** – An improved version of STP that offers faster convergence times.

## Security Considerations in Ethernet LAN Switching

To ensure a secure switching environment, administrators implement various security mechanisms:

13. **Port Security** – Restricts the number of MAC addresses per port and can disable a port if unauthorized devices are detected.
14. **Dynamic ARP Inspection (DAI)** – Prevents ARP spoofing attacks.
15. **DHCP Snooping** – Protects against rogue DHCP servers.
16. **VLAN Access Control Lists (VACLs)** – Controls traffic flow within VLANs.

## Multi-Switch Network Communication

When multiple switches are used, MAC address learning and forwarding continue across devices:

- Switches share learned MAC addresses to ensure efficient data delivery.
- Frames are forwarded across inter-switch links when necessary.
- Redundant paths may exist but should be managed using STP.




----

