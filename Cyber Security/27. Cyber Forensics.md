
 **Cyber forensics refers to the practice of extracting information, analyzing the data, and gaining intelligence. This data is specific to activities that one can present in a court of law as a structured chain of evidence.**

The major challenge of cyber forensics is actually finding, collecting, preserving, and presenting data in a manner that is admissible in a court of law.

Electronic evidence is fragile and can easily be modified. Additionally, cybercriminals, dishonest employees, and even well-intentioned users may hide, disguise, encrypt, or destroy evidence stored on digital media using various freeware, shareware, and commercially available utility programs.

Cyber forensics is both an art and a science, and it is still in its infancy.

With technology evolving, mutating, and changing at a rapid pace, the rules governing the application of cyber forensics to forensic auditing are constantly evolving.

New techniques and procedures are developed to provide information security professionals with better methods for finding, collecting, and preserving electronic evidence for use in legal proceedings against cybercriminals.

 **NOTE:** 
 
- To conduct cyber forensics, we need real evidence, such as barcodes, magnetic tapes, and electronic transaction records, to reconstruct incidents in a structured sequence for defense.  

- In most cases, forensic investigations are conducted in situations involving breaches of contract, copyright infringement, and intellectual property theft.  


## Principles of Cyber Forensics

Cyber forensics primarily focuses on identifying and recovering digital evidence from computers.
The key principles include:

- **Preservation**
  
- **Collection**
  
- **Validation**
  
- **Identification**
  
- **Analysis**
  
- **Interpretation**
  
- **Documentation**
  
- **Presentation**


## The Cyber Forensics Process

The digital forensics process may change from one scenario to another, but it typically consists of four core steps—collection, examination, analysis, and reporting.

#### Collection

The collection phase involves acquiring digital evidence, usually by seizing physical assets, such as computers, hard drives, or phones. It is critical to ensure that data is not lost or damaged during the collection process. You can prevent data loss by copying storage media or creating images of the original.

#### Examination

The examination phase involves identifying and extracting data. You can split this phase into several steps—prepare, extract, and identify.

When preparing to extract data, you can decide whether to work on a live or dead system. For example, you can power up a laptop to work on it live or connect a hard drive to a lab computer.

During the identification step, you need to determine which pieces of data are relevant to the investigation. For example, warrants may restrict an investigation to specific pieces of data.

#### Analysis

The analysis phase involves using collected data to prove or disprove a case built by the examiners. Here are key questions examiners need to answer for all relevant data items:

- Who created the data
  
- Who edited the data

- How the data was created

- When these activities occur


In addition to supplying the above information, examiners also determine how the information relates to the case.

#### Reporting

The reporting phase involves synthesizing the data and analysis into a format that makes sense to laypeople. These reports are essential because they help convey the information so that all stakeholders can understand.


## Different Branches of Cyber Forensics

Here is a brief overview of the main types of digital forensics:

#### Computer Forensics

Computer forensic science (computer forensics) investigates computers and digital storage evidence. It involves examining digital data to identify, preserve, recover, analyze and present facts and opinions on inspected information.

This branch of computer forensics uses similar principles and techniques to data recovery, but includes additional practices and guidelines that create a legal audit trail with a clear chain of custody.

#### Mobile Device Forensics

Mobile device forensics focuses primarily on recovering digital evidence from mobile devices. It involves investigating any device with internal memory and communication functionality, such as mobile phones, PDA devices, tablets, and GPS devices.

#### Network Forensics

The network forensics field monitors, registers, and analyzes network activities. Network data is highly dynamic, even volatile, and once transmitted, it is gone. It means that network forensics is usually a proactive investigation process.

#### Forensic Data Analysis

Forensic data analysis (FDA) focuses on examining structured data, found in application systems and databases, in the context of financial crime. FDA aims to detect and analyze patterns of fraudulent activity.

#### Database Forensics

Database forensics involves investigating access to databases and reporting changes made to the data. You can apply database forensics to various purposes. For example, you can use database forensics to identify database transactions that indicate fraud.

Alternatively, your database forensics analysis may focus on timestamps associated with the update time of a row in your relational database. This investigation aims to inspect and test the database for validity and verify the actions of a certain database user.


## Digital Evidence in Cyber Forensics

Digital evidence refers to **any information stored or transmitted in digital form** that can be used in investigations. It plays a crucial role in **proving cybercrimes, identifying suspects, and reconstructing incidents** in cyber forensics.

**Characteristics of Digital Evidence**

1. **Intangible** – Unlike physical evidence (e.g., fingerprints), digital evidence exists in electronic form and requires special tools to extract.
2. **Easily Altered** – Can be modified, deleted, or encrypted if not properly preserved.
3. **Time-Sensitive** – Some data, like **network logs and volatile memory (RAM), can be lost if not captured immediately**.
4. **Can Be Hidden** – Criminals use methods like **encryption, steganography, and anonymization** to conceal evidence.

### Types of Digital Evidence


**1. Computer-Based Evidence**

Digital data stored in **hard drives, SSDs, USBs, or external storage devices**.  
**Examples:**

- Deleted emails proving fraudulent activities.
- Log files from an OS showing unauthorized access.
- Browser history showing visits to malicious websites.

**2. Network-Based Evidence**

Captured network traffic or logs from **firewalls, routers, or servers**.  
**Examples:**

- **IP logs** showing where a hacking attempt originated.
- **Packet captures (PCAP files)** from tools like Wireshark revealing a data exfiltration attempt.
- **Email headers** showing phishing attempts or fake sender details.

**3. Mobile Device Evidence**

Data retrieved from **smartphones, tablets, or smartwatches**.  
**Examples:**

- **Deleted WhatsApp messages** from a suspect's phone.
- **GPS location data** placing a criminal at a crime scene.
- **Call logs and SMS messages** confirming illegal communication.


**4. Cloud-Based Evidence**

Data stored in **Google Drive, OneDrive, AWS, etc.** that can be remotely accessed.  
**Examples:**

- **Logins from unusual locations**, indicating an account compromise.
- **Backup files** containing stolen company data.
- **Transaction records** showing money laundering activities.


**5. IoT and Smart Device Evidence**

Smart home devices, **CCTV cameras, fitness trackers, and connected cars** can store valuable data.  
**Examples:**

- **A smart doorbell camera** recording a hacker entering a premises.
- **Voice recordings** from smart assistants (e.g., Alexa) capturing a crime in progress.
- **Car GPS logs** showing a suspect’s movements.


**6. Memory-Based Evidence (Volatile Data)**

RAM and running processes that **disappear when a device is powered off**.  
**Examples:**

- **RAM dumps** showing malware activity before encryption.
- **Running processes** proving a ransomware attack was active.
- **Clipboard data** containing stolen passwords.


**7. Malware and Code-Based Evidence**

Digital traces left behind by malicious software.  
**Examples:**

- **Trojan horse malware code** proving a targeted attack.
- **Keylogger logs** capturing user credentials.
- **Ransomware encryption keys** needed for decryption.

---

## Forensic Software and Hardware

**1. Forensic Toolkit (FTK)**

Features of Forensic Toolkit:

1. Advanced code-breaking and password recovery capabilities.
2. Enhanced email support for forensic analysis.
3. Powerful search functionality for deep data exploration.
4. Broad filesystem support, including FAT, NTFS, and EXT formats.
5. Deep and mature data processing engine for comprehensive forensic investigations.
6. Integrated database that eliminates data integrity issues.
7. User-friendly interface for ease of use.
8. Unmatched speed and multi-processor support for faster investigations.


**2. CD/DVD Inspector**

Features:

1. MD5 hashing capability for data integrity verification.
2. File scanning capability for identifying recoverable data.
3. Ability to create ZIP images from media for forensic analysis.
4. Disk memory checkpoint to track changes.
5. Improved encoding capabilities for better data extraction.


**3. Device Seizure Toolbox (Hardware)**

- Designed as a collection of essential items for various scenarios involving device seizure.
- When combined with appropriate forensic software, it enables efficient data acquisition from seized devices.


**4. Spector Pro**

- A software tool used for monitoring and recording all PC and internet activity on a targeted computer.


**5. LiveWire Investigator**

Features:

1. Lightweight network investigation tool.
2. Helps acquire system information.
3. Supports physical memory imaging.
4. Capability to capture remote screenshots.
5. Active monitoring of system processes and network activity.
6. Tracks network state and open connections.
7. Intelligent file acquisition for forensic analysis.
8. Dynamic indexing and analysis for quick evidence retrieval.


**6. On-Scene Investigator Software**

- Built for first responders at a crime scene or investigators who need to quickly review or copy information from a suspect's computer.
- **Note:** Requires a **Class Super CD** and a **crossover cable** for operation.

Features:

1. Cost-effective forensic solution.
2. Quick searching capability.
3. Performs imaging of computers for evidence collection.


**7. F-Response**

- Designed to enable forensic investigators to conduct live forensic data recovery and **eDiscovery** over an IP network using their own tools.


**8. Road**

- A forensic software developed for **data acquisition and analysis**.
- Also designed for **fast and reliable hard drive imaging**.


**9. Forensic Disk Data Collector**

- Used for imaging hard drives in forensic investigations.
- Creates disk images that are **readable by forensic software**.
- Supports **MD5 hashing** to verify data integrity.


**10. Disk Blocker**

- Hardware devices that allow the acquisition of information from a drive **without the risk of accidentally modifying its contents**.
- Essential for forensic investigations to maintain data integrity.

---

### Collection and Preservation of Digital Evidence

To maintain **integrity and admissibility in court**, digital evidence must be:

- **Collected lawfully** – Using forensic tools like EnCase, FTK, or Autopsy.
- **Preserved properly** – Making **bit-by-bit forensic copies** to prevent data alteration.
- **Documented correctly** – Keeping a **chain of custody** to track who handled the evidence.
- **Analyzed systematically** – Using forensic software to reconstruct cyber incidents.


## What Is Need To Conduct Cyber Forensic

- **Dedicated High-Performance Workstation** – A powerful system capable of handling large datasets and forensic analysis tasks.
  
- **Write-Block Hardware** – Prevents modification of original data while making forensic copies.
  
- **Laptop for On-Site Forensics** – Portable system for field investigations and data acquisition.
  
- **Multiple Spare Hard Drives** – Used for storing forensic images and backups.
  
- **Write-Once Media** – CDs, DVDs, or other non-rewritable storage for securely storing evidence.
  
- **Forensic Software** – Tools such as EnCase, FTK, Autopsy, and Magnet AXIOM for data analysis and recovery.


## Requirements For Computer Forensics

### 1. Hardware Requirements

- Must be highly familiar with **internal and external computer components**.
  
- Have a **thorough understanding of hard drives** and their configurations, including file systems and partitions.
  
- Knowledge of **motherboards and chipsets** used in different systems.
  
- Understanding of **different types of memory (RAM, ROM, cache, etc.)**.
  
- **BIOS/UEFI Knowledge** – Understanding its functions, settings, and limitations.
  
- **Operating System Knowledge** – Familiarity with **Windows, Linux (UNIX-based systems), and macOS**.
  
- Experience with **different virtual machines** for forensic testing and sandboxing environments.


### 2. Software Requirements

- **General Software Proficiency** – Familiarity with essential software packages such as Microsoft Office for documentation and reporting.
  
- **Forensic Tools** – Proficiency in forensic techniques and specialized software such as:
    - **EnCase** – Used for disk analysis and evidence recovery.
    - **FTK (Forensic Toolkit)** – For data acquisition and indexing.
    - **Autopsy** – Open-source forensic analysis tool.
    - **Wireshark** – For network packet analysis.
    - **Volatility** – For memory forensics.
    - **Magnet AXIOM** – Digital forensic and mobile data extraction tool.
    - **Kali Linux tools** – Used for penetration testing and forensic analysis.

## Challenges with cyber forensics

Cyber forensics experts extract data from a variety of sources — any technologies that may be used by an end-user. These include mobile devices, cloud computing services, IT networks, and software applications.

Distinct vendors develop and operate these technologies. The technology limitations and privacy measures tend to restrict the investigative capacity of an individual InfoSec expert as they face the following challenges:

- **Data recovery.** If the data is encrypted, the investigator will not be able to decrypt the information without access to encryption keys. New storage tools such as SSD devices may not offer immediate factory access to recover lost data, unlike traditional magnetic tape and hard disk drive systems.
  
- **Visibility into cloud system.** Investigators may only have access to metadata but not the information content of the files. The underlying resources may be shared and allocated dynamically. That lack of access to physical storage systems means that third-party investigators might not recover lost data.
  
- **Network log big data.** Network log data grows exponentially and requires advanced analytics and AI tools to connect the dots and find insightful relationships between networking activities.
  
- **Multi-jurisdiction data storage.** If the data is stored in a different geographic location, cyber forensics investigators may not have the legal authority to access the required information.

While there are challenges with cyber forensics, there are also resources that can help you minimize their impact, if not overcome them.

---

## Classification of Data Collected in Cyber Forensics

**1. Host-Based Information**

- This type of evidence includes **log records, documents, and any other data** found on a system rather than **network-based sources**.
- Host-based information may include **system backups**, which preserve evidence at a specific point in time.
- Data collection is done in **two primary ways**:
    1. **Live data collection** (retrieving information while the system is running).
    2. **Forensic duplication** (creating an exact copy of the system for analysis).

**Volatile Information Recorded in Host-Based Analysis:**

i. System date and time.  
ii. Applications currently running on the system.  
iii. All active network connections.  
iv. Open sockets.  
v. Applications listening on a specific socket.  
vi. Network interface status.  
vii. Temporary files (some may be lost if not collected immediately).

---

**2. Network-Based Information**

- Network-based evidence can be obtained from various sources, including:
    
    1. **Intrusion Detection System (IDS) logs**
    2. **Network monitoring logs**
    3. **Router logs**
       
- Organizations typically perform **network surveillance** (**consensual monitoring**) to:
    
    1. Confirm suspicions regarding a **computer security incident**.
    2. Gather **additional evidence** or relevant information.
    3. Verify the **extent of a security breach**.
    4. Identify **additional parties** involved.
    5. Establish a **timeline of network events**.
    6. Ensure **compliance with security policies**.
       
- Network-based analysis fills gaps where **host-based auditing** may fail.
    

---

**3. Other Forms of Evidence**

- This category includes **testimonies** and information gathered from individuals during investigations.

**Important Note:**  
Computer forensic experts can **retrieve data from various storage systems and operating systems**, even when anti-forensic tools are deployed. Using specialized forensic tools, experts can:

1. Retrieve data from **seemingly inaccessible** storage media.
2. Access **active** data stored on devices.
3. Recover **deleted** files.
4. Extract **inactive or unused** data from various storage devices.
5. Access **password-protected** and **encrypted** files.
6. Gather data from **databases, contact managers, electronic calendars, and other relevant software**.

---

##  Computer Forensics for Windows

Computer forensics is an essential field of cyber security that involves gathering evidence of activities performed on computers. 

It is a part of the wider Digital Forensics field, which deals with forensic analysis of all types of digital devices, including recovering, examining, and analyzing data found in digital devices.

Microsoft Windows is by large the most used Desktop Operating System right now. Private users and Enterprises prefer it, and it currently holds roughly 80% of the Desktop market share. This means that it is important to know how to perform forensic analysis on Microsoft Windows for someone interested in Digital Forensics.

### Forensic Artifacts

Forensic artifacts are essential pieces of information that provide evidence of human activity. For example, during the investigation of a crime scene, fingerprints, a broken button of a shirt or coat, the tools used to perform the crime are all considered forensic artifacts. 

All of these artifacts are combined to recreate the story of how the crime was committed. These artifacts often reside in locations 'normal' users won't typically venture to.

A Windows system keeps track of a lot of activity performed by a user.

Assuming the same build of Windows is installed on a system, excluding the actions taken during installation, the out-of-the-box experience is similar for all users. However, with time, each user personalizes their computer according to their preferences. 

These preferences include the Desktop layout and icons, the bookmarks in the internet browser, the name of the user, installing of different applications, and logging in to different accounts for each of these applications and other accounts using the internet browser.

Windows saves these preferences to make your computer more personalized. However, forensic investigators use these preferences as artifacts to identify the activity performed on a system. 

So while your computer might be spying on you, it is not for the explicit reason of spying, instead to make it more pleasant to use the computer according to your taste. But that same information is used by forensic investigators to perform forensic analysis.


## Windows Registry

The Windows Registry is a collection of databases that contains the system's configuration data. This configuration data can be about the hardware, the software, or the user's information. It also includes data about the recently used files, programs used, or devices connected to the system. As you can understand, this data is beneficial from a forensics standpoint.

You can view the registry using `regedit.exe`, a built-in Windows utility to view and edit the registry.

The Windows registry consists of Keys and Values. When you open the regedit.exe utility to view the registry, the folders you see are Registry Keys. Registry Values are the data stored in these Registry Keys. 

A Registry Hive is a group of Keys, subkeys, and values stored in a single file on the disk.

**Structure of the Registry:**

The registry on any Windows system contains the following five root keys:

1. HKEY_CURRENT_USER
2. HKEY_USERS
3. HKEY_LOCAL_MACHINE
4. HKEY_CLASSES_ROOT
5. HKEY_CURRENT_CONFIG

You can view these keys when you open the `regedit.exe` utility. 

In this prompt, type `regedit.exe` , and you will be greeted with the registry editor window. It will look something like this:

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/e14ef3193fce1f4b35c37a96862d71da.png)

Here you can see the root keys in the left pane in a tree view that shows the included registry keys, and the values in the selected key are shown in the right pane. You can right-click on the value shown in the right pane and select properties to view the properties of this value.

|Folder/predefined key|Description|
|---|---|
|**HKEY_CURRENT_USER**|Contains the root of the configuration information for the user who is currently logged on. The user's folders, screen colors, and Control Panel settings are stored here. This information is associated with the user's profile. This key is sometimes abbreviated as HKCU.|
|**HKEY_USERS**|Contains all the actively loaded user profiles on the computer. HKEY_CURRENT_USER is a subkey of HKEY_USERS. HKEY_USERS is sometimes abbreviated as HKU.|
|**HKEY_LOCAL_MACHINE**|Contains configuration information particular to the computer (for any user). This key is sometimes abbreviated as HKLM.|
|**HKEY_CLASSES_ROOT**|Is a subkey of `HKEY_LOCAL_MACHINE\Software` . The information that is stored here makes sure that the correct program opens when you open a file by using Windows Explorer. This key is sometimes abbreviated as HKCR.<br><br>Starting with Windows 2000, this information is stored under both the HKEY_LOCAL_MACHINE and HKEY_CURRENT_USER keys. The `HKEY_LOCAL_MACHINE\Software\Classes` key contains default settings that can apply to all users on the local computer.  The `HKEY_CURRENT_USER\Software\Classes` key has settings that override the default settings and apply only to the interactive user.<br><br>The HKEY_CLASSES_ROOT key provides a view of the registry that merges the information from these two sources. HKEY_CLASSES_ROOT also provides this merged view for programs that are designed for earlier versions of Windows. To change the settings for the interactive user, changes must be made under `HKEY_CURRENT_USER\Software\Classes` instead of under HKEY_CLASSES_ROOT.<br><br>To change the default settings, changes must be made under `HKEY_LOCAL_MACHINE\Software\Classes`  .If you write keys to a key under HKEY_CLASSES_ROOT, the system stores the information under `HKEY_LOCAL_MACHINE\Software\Classes` .<br><br>If you write values to a key under HKEY_CLASSES_ROOT, and the key already exists under `HKEY_CURRENT_USER\Software\Classes` , the system will store the information there instead of under `HKEY_LOCAL_MACHINE\Software\Classes` .|
|**HKEY_CURRENT_CONFIG**|Contains information about the hardware profile that is used by the local computer at system startup.|


## Accessing registry hives offline

If you are accessing a live system, you will be able to access the registry using regedit.exe, and you will be greeted with all of the standard root keys we learned about in the previous task. However, if you only have access to a disk image, you must know where the registry hives are located on the disk. The majority of these hives are located in the `C:\Windows\System32\Config` directory and are:

1. **DEFAULT** (mounted on `HKEY_USERS\DEFAULT`)
2. **SAM** (mounted on `HKEY_LOCAL_MACHINE\SAM`)
3. **SECURITY** (mounted on `HKEY_LOCAL_MACHINE\Security`)
4. **SOFTWARE** (mounted on `HKEY_LOCAL_MACHINE\Software`)
5. **SYSTEM** (mounted on `HKEY_LOCAL_MACHINE\System`)

**Hives containing user information:**

Apart from these hives, two other hives containing user information can be found in the User profile directory. For Windows 7 and above, a user’s profile directory is located in `C:\Users\<username>\` where the hives are:

1. **NTUSER.DAT** (mounted on HKEY_CURRENT_USER when a user logs in)
2. **USRCLASS.DAT** (mounted on HKEY_CURRENT_USER\Software\CLASSES)

The USRCLASS.DAT hive is located in the directory `C:\Users\<username>\AppData\Local\Microsoft\Windows`. 

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/3ffadf20ebe241040d659958db115c2f.png)  

The NTUSER.DAT hive is located in the directory `C:\Users\<username>\`.

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/f3091f38f680b418f89cf79128d1933c.png)

Remember that NTUSER.DAT and USRCLASS.DAT are hidden files.

**The Amcache Hive:**

Apart from these files, there is another very important hive called the AmCache hive. This hive is located in `C:\Windows\AppCompat\Programs\Amcache.hve`. Windows creates this hive to save information on programs that were recently run on the system.

**Transaction Logs and Backups:**

Some other very vital sources of forensic data are the registry transaction logs and backups. The transaction logs can be considered as the journal of the changelog of the registry hive. Windows often uses transaction logs when writing data to registry hives. This means that the transaction logs can often have the latest changes in the registry that haven't made their way to the registry hives themselves. The transaction log for each hive is stored as a .LOG file in the same directory as the hive itself. It has the same name as the registry hive, but the extension is .LOG. For example, the transaction log for the SAM hive will be located in `C:\Windows\System32\Config` in the filename SAM.LOG. Sometimes there can be multiple transaction logs as well. In that case, they will have .LOG1, .LOG2 etc., as their extension. It is prudent to look at the transaction logs as well when performing registry forensics.

Registry backups are the opposite of Transaction logs. These are the backups of the registry hives located in the `C:\Windows\System32\Config` directory. These hives are copied to the `C:\Windows\System32\Config\RegBack` directory every ten days. It might be an excellent place to look if you suspect that some registry keys might have been deleted/modified recently.


## Data Acquisition

When performing forensics, we will either encounter a live system or an image taken of the system. For the sake of accuracy, it is recommended practice to image the system or make a copy of the required data and perform forensics on it. This process is called data acquisition.

Though we can view the registry through the registry editor, the forensically correct method is to acquire a copy of this data and perform analysis on that. However, when we go to copy the registry hives from `%WINDIR%\System32\Config` , we cannot because it is a restricted file. So, what to do now?

For acquiring these files, we can use one of the following tools: 

#### 1. Kroll Artifact Parser And Extractor (KAPE)

KAPE is a live data acquisition and analysis tool which can be used to acquire registry data. It is primarily a command-line tool but also comes with a GUI.

![][https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/48b9656c4037d0537bf517d6084517a8.png]

---

#### 2. Autopsy

Autopsy  gives you the option to acquire data from both live systems or from a disk image. After adding your data source, navigate to the location of the files you want to extract, then right-click and select the Extract File(s) option.

![][https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/5faf350078f7e7e1d1400f46e11e74a9.png]

---

#### 4. FTK Imager

FTK Imager  is similar to Autopsy and allows you to extract files from a disk image or a live system by mounting the said disk image or drive in FTK Imager.

![][https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/08b1f97dd47b33c4261fb362d49ac929.png]

---

Another way you can extract Registry files from FTK Imager is through the Obtain Protected Files option. This option is only available for live systems and is highlighted in the screenshot below. This option allows you to extract all the registry hives to a location of your choosing. However, it will not copy the `Amcache.hve` file, which is often necessary to investigate evidence of programs that were last executed.

![][https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/6aa5e6825bb003dc803106d5f70e155c.png]

---

## Exploring Windows Registry

Once we have extracted the registry hives, we need a tool to view these files as we would in the registry editor. Since the registry editor only works with live systems and can't load exported hives, we can use the following tools:

**Registry Viewer:**

As we can see in the screenshot below, AccessData's Registry Viewer has a similar user interface to the Windows Registry Editor. There are a couple of limitations, though. It only loads one hive at a time, and it can't take the transaction logs into account.

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/888afb265fa265d771dc02ae8f610dc0.png)

**Zimmerman's Registry Explorer:**

Eric Zimmerman has developed a handful of tools that are very useful for performing Digital Forensics and Incident Response. One of them is the Registry Explorer. 

It can load multiple hives simultaneously and add data from transaction logs into the hive to make a more 'cleaner' hive with more up-to-date data. It also has a handy 'Bookmarks' option containing forensically important registry keys often sought by forensics investigators. Investigators can go straight to the interesting registry keys and values with the bookmarks menu item. 

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/414dee2639b9456334c9580aacdc2be1.png)  
  
  **RegRipper:**

RegRipper is a utility that takes a registry hive as input and outputs a report that extracts data from some of the forensically important keys and values in that hive. The output report is in a text file and shows all the results in sequential order. 

RegRipper is available in both a CLI and GUI form.

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/70e6fef3920cb9b0443bc1fa9d9fac5d.png)

One shortcoming of RegRipper is that it does not take the transaction logs into account. We must use Registry Explorer to merge transaction logs with the respective registry hives before sending the output to RegRipper for a more accurate result.

---

## System Information and System Accounts


### OS Version

We can determine the OS version from which this data was pulled through the registry. To find the OS version, we can use the following registry key:

`SOFTWARE\Microsoft\Windows NT\CurrentVersion`

This is how Registry Explorer shows this registry key. Take a look and answer Question # 1.

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/1362c5a15d1879a1a5a5a5237a426108.png)    

---

### Current control set

The hives containing the machine’s configuration data used for controlling system startup are called Control Sets. Commonly, we will see two Control Sets, ControlSet001 and ControlSet002, in the SYSTEM hive on a machine. In most cases (but not always), ControlSet001 will point to the Control Set that the machine booted with, and ControlSet002 will be the `last known good`  configuration. Their locations will be:

`SYSTEM\ControlSet001`

`SYSTEM\ControlSet002`

Windows creates a volatile Control Set when the machine is live, called the CurrentControlSet ( `HKLM\SYSTEM\CurrentControlSet` ). For getting the most accurate system information, this is the hive that we will refer to. We can find out which Control Set is being used as the CurrentControlSet by looking at the following registry value:

`SYSTEM\Select\Current`

Similarly, the `last known good` configuration can be found using the following registry value:

`SYSTEM\Select\LastKnownGood`

### Computer Name

It is crucial to establish the Computer Name while performing forensic analysis to ensure that we are working on the machine we are supposed to work on. We can find the Computer Name from the following location:

`SYSTEM\CurrentControlSet\Control\ComputerName\ComputerName`


### Time Zone Information

For accuracy, it is important to establish what time zone the computer is located in. This will help us understand the chronology of the events as they happened. For finding the Time Zone Information, we can look at the following location:

`SYSTEM\CurrentControlSet\Control\TimeZoneInformation`

Time Zone Information is important because some data in the computer will have their timestamps in UTC/GMT and others in the local time zone. Knowledge of the local time zone helps in establishing a timeline when merging data from all the sources.

### Network Interfaces and Past Networks

The following registry key will give a list of network interfaces on the machine we are investigating:

`SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces`

Each Interface is represented with a unique identifier (GUID) subkey, which contains values relating to the interface’s TCP/IP configuration. This key will provide us with information like IP addresses, DHCP IP address and Subnet Mask, DNS Servers, and more. This information is significant because it helps you make sure that you are performing forensics on the machine that you are supposed to perform it on.

The past networks a given machine was connected to can be found in the following locations:

`SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Signatures\Unmanaged`

`SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Signatures\Managed`


### Recent Files

Windows maintains a list of recently opened files for each user. As we might have seen when using Windows Explorer, it shows us a list of recently used files.  This information is stored in the NTUSER hive and can be found on the following location:

`NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs`

Registry Explorer allows us to sort data contained in registry keys quickly. For example, the Recent documents tab arranges the Most Recently Used (MRU) file at the top of the list. Registry Explorer also arranges them so that the Most Recently Used (MRU) file is shown at the top of the list and the older ones later.

Another interesting piece of information in this registry key is that there are different keys with file extensions, such as  `.pdf` , `.jpg` , `.docx`  etc. These keys provide us with information about the last used files of a specific file extension. So if we are looking specifically for the last used PDF files, we can look at the following registry key:

`NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.pdf`

Registry Explorer also lists the Last Opened time of the files.

### Office Recent Files

Similar to the Recent Docs maintained by Windows Explorer, Microsoft Office also maintains a list of recently opened documents. This list is also located in the NTUSER hive. It can be found in the following location:

`NTUSER.DAT\Software\Microsoft\Office\VERSION`

The version number for each Microsoft Office release is different. An example registry key will look like this:

`NTUSER.DAT\Software\Microsoft\Office\15.0\Word`

Here, the 15.0 refers to Office 2013. A list of different Office releases and their version numbers.

Starting from Office 365, Microsoft now ties the location to the user's live ID. In such a scenario, the recent files can be found at the following location. 

`NTUSER.DAT\Software\Microsoft\Office\VERSION\UserMRU\LiveID_####\FileMRU`


### ShellBags

When any user opens a folder, it opens in a specific layout. Users can change this layout according to their preferences. These layouts can be different for different folders. This information about the Windows _'shell'_  is stored and can identify the Most Recently Used files and folders. Since this setting is different for each user, it is located in the user hives. We can find this information on the following locations:

`USRCLASS.DAT\Local Settings\Software\Microsoft\Windows\Shell\Bags`

`USRCLASS.DAT\Local Settings\Software\Microsoft\Windows\Shell\BagMRU`

`NTUSER.DAT\Software\Microsoft\Windows\Shell\BagMRU`

`NTUSER.DAT\Software\Microsoft\Windows\Shell\Bags`

Registry Explorer doesn't give us much information about ShellBags. 

ShellBag Explorer shows us the information in an easy-to-use format. We just have to point to the hive file we have extracted, and it parses the data and shows us the results.


### Open/Save and LastVisited Dialog MRUs:

When we open or save a file, a dialog box appears asking us where to save or open that file from. It might be noticed that once we open/save a file at a specific location, Windows remembers that location. This implies that we can find out recently used files if we get our hands on this information. We can do so by examining the following registry keys

`NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\OpenSavePIDlMRU`

`NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\LastVisitedPidlMRU`


### Windows Explorer Address/Search Bars

Another way to identify a user's recent activity is by looking at the paths typed in the Windows Explorer address bar or searches performed using the following registry keys, respectively.

`NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\TypedPaths`

`NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\WordWheelQuery`



## Evidence of Execution


### UserAssist

Windows keeps track of applications launched by the user using Windows Explorer for statistical purposes in the User Assist registry keys. These keys contain information about the programs launched, the time of their launch, and the number of times they were executed. However, programs that were run using the command line can't be found in the User Assist keys. The User Assist key is present in the NTUSER hive, mapped to each user's GUID. We can find it at the following location:

`NTUSER.DAT\Software\Microsoft\Windows\Currentversion\Explorer\UserAssist\{GUID}\Count`


### ShimCache

ShimCache is a mechanism used to keep track of application compatibility with the OS and tracks all applications launched on the machine. Its main purpose in Windows is to ensure backward compatibility of applications. It is also called Application Compatibility Cache (AppCompatCache). It is located in the following location in the SYSTEM hive:

`SYSTEM\CurrentControlSet\Control\Session Manager\AppCompatCache`

ShimCache stores file name, file size, and last modified time of the executables.

We can use the following command to run the AppCompatCache Parser Utility:

`AppCompatCacheParser.exe --csv <path to save output> -f <path to SYSTEM hive for data parsing> -c <control set to parse>`

The output can be viewed using EZviewer, another one of Eric Zimmerman's tools.


### AmCache

The AmCache hive is an artifact related to ShimCache. This performs a similar function to ShimCache, and stores additional data related to program executions. This data includes execution path, installation, execution and deletion times, and SHA1 hashes of the executed programs. This hive is located in the file system at:

`C:\Windows\appcompat\Programs\Amcache.hve`

Information about the last executed programs can be found at the following location in the hive:

`Amcache.hve\Root\File\{Volume GUID}\`


### BAM/DAM

Background Activity Monitor or BAM keeps a tab on the activity of background applications. Similar Desktop Activity Moderator or DAM is a part of Microsoft Windows that optimizes the power consumption of the device. Both of these are a part of the Modern Standby system in Microsoft Windows.

In the Windows registry, the following locations contain information related to BAM and DAM. This location contains information about last run programs, their full paths, and last execution time.

`SYSTEM\CurrentControlSet\Services\bam\UserSettings\{SID}`

`SYSTEM\CurrentControlSet\Services\dam\UserSettings\{SID}`


## External Devices/USB device forensics


When performing forensics on a machine, often the need arises to identify if any USB or removable drives were attached to the machine. If so, any information related to those devices is important for a forensic investigator.

### Device identification:

The following locations keep track of USB keys plugged into a system. These locations store the vendor id, product id, and version of the USB device plugged in and can be used to identify unique devices. These locations also store the time the devices were plugged into the system.

`SYSTEM\CurrentControlSet\Enum\USBSTOR`

`SYSTEM\CurrentControlSet\Enum\USB`


### First/Last Times:

Similarly, the following registry key tracks the first time the device was connected, the last time it was connected and the last time the device was removed from the system.

`SYSTEM\CurrentControlSet\Enum\USBSTOR\Ven_Prod_Version\USBSerial#\Properties\{83da6326-97a6-4088-9453-a19231573b29}\####`

In this key, the #### sign can be replaced by the following digits to get the required information:

|   |   |
|---|---|
|**Value**|**Information**|
|0064|First Connection time|
|0066|Last Connection time|
|0067|Last removal time|

Although we can check this value manually, as we have seen above, Registry Explorer already parses this data and shows us if we select the USBSTOR key.

**USB device Volume Name:**

The device name of the connected drive can be found at the following location:

`SOFTWARE\Microsoft\Windows Portable Devices\Devices`

