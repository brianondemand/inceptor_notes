
As a penetration tester, efficiency is key — why manually probe for vulnerabilities when Nmap Scripting Engine (NSE) can automate and enhance your workflow? NSE extends Nmap’s capabilities, allowing for advanced recon, exploitation, and evasion techniques.

The Nmap Scripting Engine (NSE) help us to:

- Automate tedious reconnaissance
- Brute-force weak credentials
- Detect critical vulnerabilities
- Bypass firewalls and IDS/IPS
- Aid in privilege escalation



## Reconnaissance & Host Enumeration

Reconnaissance gathers information about a target network, while host enumeration identifies active hosts within it.

Before launching attacks, you need to **map the target environment**. These scripts help identify live hosts, subdomains, and exposed services.

##### Discovering Live Hosts with hostmap-bfk

```bash
nmap -sn — script=hostmap-bfk <target>
```

- **What it does**: Passively enumerates subdomains and hosts without triggering alarms.

- **Use case**: Ideal for OSINT gathering before an external penetration test.

- **Pro Tip**: Combine with — dns-servers to use a specific DNS resolver.

##### DNS Subdomain Bruteforcing with `_dns-brute_`

```bash
nmap -script=dns-brute <target>
```


- **What it does**: Discovers subdomains by brute-forcing common prefixes (e.g., admin., dev., mail.).

- **Why it’s useful**: Often reveals hidden admin panels or development environments.

- **Optimization**: Use _— script-args dns-brute.domainlist=/path/to/list.txt_ for a custom wordlist.

---

## Service & Version Enumeration

Service and version enumeration identifies running services and their versions on a target system using Nmap. This helps attackers and pentesters find vulnerabilities by revealing outdated or misconfigured software that can be exploited.

Once you’ve identified targets, the next step is service fingerprinting.


##### Deep Service Version Detection (service-version)

```bash
nmap -sV — script=service-version <target>
```


- **What it does**: Extracts exact software versions (e.g., Apache 2.4.49, OpenSSH 8.2).

- **Critical Insight**: Helps match services to known CVEs (e.g., Log4j, EternalBlue).


##### HTTP Server & Title Grabbing (http-title, http-server-header)

```bash
nmap -p 80,443 — script=http-title,http-server-header <target>
```


- **What it reveals:** Web server type (Nginx, IIS, Apache) and Page titles (e.g., “Admin Login” or “WordPress Dashboard”)

- **Attack Surface**: Exposed admin panels, CMS versions, default credentials.


##### SMB Share & User Enumeration (smb-enum-shares, smb-enum-users)

```bash
nmap -p 139,445 — script=smb-enum-shares,smb-enum-users <target>
```

- Why SMB matters: Unsecured shares → Sensitive files exposed and User lists > Helps in brute-forcing & Kerberoasting

- Bonus: Combine with smb-os-discovery for OS detection.

---

## Credential Attacks & Authentication Bypass

Credential attacks steal or crack login credentials using methods like brute force, phishing, and password spraying, while authentication bypass exploits flaws in authentication mechanisms (e.g., weak session handling, misconfigured access controls) to gain unauthorized access without valid credentials.

Weak credentials are the easiest way into a system. These scripts automate brute-forcing.

##### FTP Brute-Forcing ( _ftp-brute_ )

```bash
nmap -p 21 — script=ftp-brute <target>
```

- **Common Finds**: admin:admin, ftp:ftp, anonymous:anonymous.

- **Optimization**: Use — script-args userdb=users.txt,passdb=passwords.txt.

##### Telnet Default Credentials (_telnet-brute_)

```bash
nmap -p 23 — script=telnet-brute <target>
```

- **Why Telnet**: Many IoT devices and legacy systems still use it.

- **Default Creds**: root:root, admin:password.

##### Web Admin Panel Default Logins ( _http-default-accounts_ )

```bash
nmap -script=http-default-accounts <target>
```

- **Detects**: Default credentials for WordPress, Jenkins, Tomcat, routers.

- **Example**: admin:admin on Apache Tomcat Manager.

##### Brute Force SMB Authentication

```bash
nmap -script=smb-brute -p 445 <target>
```

- This specifies that Nmap should run the smb-brute script, which is designed to perform brute-force attacks on SMB (Server Message Block) services.

- The smb-brute script attempts to brute-force weak SMB authentication by trying multiple username and password combinations.


---

## Exploitation & Vulnerability Scanning

Vulnerability scanning **identifies security weaknesses** in a system using tools like **Nmap and many other tools like Nessus, and OpenVAS**, while exploitation **actively takes advantage of these vulnerabilities** using tools like **Metasploit, SQLMap, and Mimikatz** to gain access or escalate privileges.


##### Automated Vulnerability Scanning (vuln)

```bash
nmap -script=vuln <target>
```

- **Checks for**: CVE-2017–0144 (EternalBlue) and Shellshock, Heartbleed, Dirty COW

- **Best for**: Quick risk assessment before deeper exploitation.


##### SSL/TLS Weak Ciphers (ssl-enum-ciphers)

```bash
 nmap -script=ssl-enum-ciphers -p 443 <target>
```

- **Finds**: Outdated protocols (SSLv3, TLS 1.0) and Weak ciphers (RC4, DES)

- **Exploitation**: Man-in-the-Middle (MITM) attacks.

---

##  Firewall & IDS/IPS Evasion

Firewall and IDS/IPS evasion involves bypassing security defenses that monitor and block malicious traffic. Attackers use techniques like packet fragmentation, encryption, traffic obfuscation, and spoofing to evade detection and gain access to target systems undetected.

##### Decoy Scanning (-D)

```bash
nmap -D RND:10 <target> 

# Random 10 decoy IPs
```

- Use Case: Evades IP-based blocking by mixing real traffic with noise.

##### Packet Fragmentation (-f)

```bash
nmap -f <target>
```

- How it works: Splits packets into tiny fragments to bypass deep packet inspection.

##### MAC Address Spoofing (mac-change)

```bash
nmap -script=mac-change -script-args=newmac=00:11:22:33:44:55 <target>
```

**Why**: Some networks filter by MAC address.


---

## Post-Exploitation & Privilege Escalation

Post-exploitation maintains access and gathers valuable data after compromising a system, while privilege escalation gains higher privileges (e.g., admin/root) using exploits like misconfigurations, kernel vulnerabilities, or credential theft to expand control over the target.

After initial access, escalate privileges and move laterally.

##### Exploitable NFS Shares ( _nfs-showmoun_t )

```bash
nmap -p 111 — script=nfs-showmount <target>
```

- Attack Path: If no_root_squash is enabled, you can upload a SUID binary.

##### Windows User & Group Enumeration (smb-enum-users)

```bash
nmap -p 445 — script=smb-enum-users,smb-enum-groups <target>
```

- **Post-Exploit Use**: Find Domain Admins for lateral movement.


#### Conclusion

NSE is a powerful tool for penetration testers, automating tedious tasks and uncovering hidden vulnerabilities. Whether you’re doing recon, brute-forcing, or evading firewalls, these scripts can save time and improve efficiency.
